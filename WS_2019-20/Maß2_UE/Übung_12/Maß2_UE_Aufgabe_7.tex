\begin{exercise}

Ein anderer Weg, das vorige Beispiel zu lösen: die Anzahl der Versuche hat eine negative Binomialverteilung und diese kann (als Summe von unabhängig geometrisch verteilten Zufallsvariablen) auch durch eine Normalverteilung approximiert werden.

\end{exercise}

\begin{solution}

<<<<<<< HEAD
Sei $X$ die Zufallsvariable, welche die Anzahl der Veruche angibt, um 100 Sechser zu erreichen.
\begin{align*}
&Y_k:(\Omega,2^\Omega) \to (\R,\B): \omega \mapsto
\begin{cases}
    0, & \omega < 6, \\
    1, & \omega = 6.
\end{cases} \\
    &X:(\Omega^\N,2^{\Omega^\N}) \to (\R, \B): (\omega_n)_{n\in\N} \mapsto \min\{k\in\N: \sum_{n = 0}^kY_k = 100\}
\end{align*}
$X$ ist negativ binomialverteilt, also:
\begin{align*}
  P(X=x) = {x - 1\choose 99}(\frac{1}{6})^{100}(\frac{5}{6})^{x-100}
\end{align*}
Diese negative Binomialverteilung lässt sich schließlich als Summe 100 unabhängiger, geometrisch verteilter Zufallsvariablen darstellen:
\begin{align*}
  X \sim \sum_{k=1}^{100}X_k,
\end{align*}
wobei $X_k$ geometrisch verteilte Zufallsvariablen mit Parameter $1/6$ sind.
Darauf können wir abermals den zentralen Grenzwertsatz anwenden:
\begin{align*}
  \P(X \leq x) = \P(\sum_{k=1}^{100}\frac{X_k - 600}{\sqrt{30*100}} \leq \frac{x-600}{\sqrt{30*100}}) &\approx \Phi\pbraces{\frac{x-\frac{100}{6}}{\sqrt{30*100}}}  > \frac{9}{10} \\
  \frac{x-\frac{100}{6}}{\sqrt{30*100}} > 1.28 \\
  x > 670.108
\end{align*}
=======
Eine Zufallsvariable $X$ ist negativ Binomialverteilt $B_{neg} (r,p)$, wobei
$r$ die Anzahl der erfolgreichen Versuche und $p$ die Wahrscheinlichkeit
des Erfolges ist, wenn sie sich durch die Wahrscheinlichkeitsfunktion

\begin{align*}
  \P(X=n) = \binom{n-1}{r-1}p^r(1-p)^{n-r}
\end{align*}

angeben lässt. Dabei gelten für Erwartungswert und Varianz

\begin{align}
  \E(X) &= \frac{r(1-p)}{p} \nonumber \\
  \V(X) &= \frac{r(1-p)}{p^2} 
\end{align}

Wir wollen wissen wie oft wir Würfeln müssen um $r=100$ (wobei also $r$ die
Anzahl der $6$en ist) und erhalten also:

\begin{align*}
  \P(X=n) &= \binom{n-1}{99}\pbraces{\frac{1}{6}}^{100}\pbraces{\frac{5}{6}}^{n-100} \\
  &\text{und suchen} \\
  \P(X \leq n) &> 0,9
\end{align*}

Für $r=1$, also für einen erfolgreichen Versuch, nennt man die Verteilung auch
geometrische Verteilung. Für diese gilt

\begin{align*}
  \P(X=n)=\frac{1}{6}\pbraces{\frac{5}{6}}^{n-r}
\end{align*}

Betrachten wir die Anzahl der Würfe bis zum nächsten Erfolg, ist diese wieder
geometrisch verteilt, wir können die Anzahl der Würfe bis $100$ $6$er geworfen
werden, als

\begin{align*}
  S_{100} = \sum_{i=1}^{100}X_i
\end{align*}

schreiben, wobei $X_i$ geometrisch verteilte ZV sind. Für Erwartungswert und
Varianz erhalten wir \\
$\E(X_i)=6, \V(X_i)=30$ und der zentrale Grenzwertsatz erlaubt uns nun, folgende
Wahrscheinlichkeit durch die Standard-Normalverteilung zu approximieren:

\begin{align*}
  \P(\frac{S_{100}-600}{10\sqrt{30}} \leq \frac{n-600}{10\sqrt{30}}) \thickapprox
  \Phi(\frac{n-600}{10\sqrt{30}}) > 0,9
\end{align*}

Nachschlagen gibt uns $\Phi(1,28)=0,9$ somit erhalten wir

\begin{align*}
  \frac{n-600}{10\sqrt{30}} > 1,28 \Leftrightarrow
  n > 12,8 \cdot \sqrt{30} + 600 = 670,1
\end{align*}
Somit $n=671$ (fast) wie im vorherigen Bsp.


>>>>>>> 9c1e9e03b5cb9e0376f57573526d83fafd8c39c3

Anmerkung: eine heuristische Erklärung (die für mich Sinn macht), nichts Formales: Die negative Binomialverteilung $B_{neg}\pbraces{100,\frac{1}{6}}$ gibt an, wie oft man nicht $6$ gewürfelt hat, bis man $100$ Mal $6$ gewürfelt hat. Das heißt $\mathbb{P}(X=n)$ ist die Wahrscheinlichkeit $n$ Mal nicht Sechs gewürfelt zu haben, bis man $100$ Mal 6 gewürfelt hat. Ist nun also eine Zufallsvariable $S_{100} \sim B_{neg}\pbraces{100,\frac{1}{6}}$ negativ binomialverteilt (ist eventuell leider ein wenig ein anderes $S_{100}$ also oben) und $Y_n$ (aus Aufgabe 6) gibt mir die Anzahl der $6$er nach $n$ Würfen, so modellieren wir nun $Y_n \approx n - S_{100}$, also Anzahl der Sechser $Y_n$ ist ist Anzahl der Würfe $n$ minus Anzahl der nicht Sechser $S_{100}$. Wir schreiben also $\mathbb{P}\pbraces{Y_n \geq 100} = \mathbb{P}\pbraces{n - S_{100} \geq 100} = \mathbb{P}\pbraces{S_{100} \leq n - 100} = \mathbb{P}\pbraces{\frac{S_{100} - \mathbb{E}(S_{100})}{\sqrt{\mathbb{V}(S_{100})}} \leq \frac{(n-100) - \mathbb{E}(S_{100})}{\sqrt{\mathbb{V}(S_{100})}}}$, wobei $\mathbb{E}(S_{100}),\mathbb{V}(S_{100})$ nach (2) berechnet werden können. Danach gehts so weiter wie oben.
\end{solution}

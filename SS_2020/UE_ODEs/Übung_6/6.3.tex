\begin{exercise}
  In Aufgabe 5.1 haben wir homogene (skalare) ODEs kennengelernt und durch
  Substitution auf eine separierte ODE zurückgeführt. Ein allgemeinerer Typ ist
  von der Form

  \begin{align} \label{allgemeiner Typ}
    y' = f \bigg(\frac{ay + bt + c}{\alpha y + \beta t + \gamma}
    \bigg)
  \end{align}

  für Konstanten $a,b,c,\alpha ,\beta ,\gamma$. Ziel ist es, durch Variablensubstitution
  eine separierbare ODE zu erhalten. Definieren Sie hierzu die Matrix

  \begin{align*}
    A = \left(
      \begin{array}{cc}
        a & b \\
        \alpha & \beta
      \end{array}
    \right)
  \end{align*}

  \begin{itemize}
    \item[a)] Betrachten Sie den Fall $\det A = 0$. Hinweis: Bemerken Sie, dass
    $ay +bt = \lambda (\alpha y + \beta t)$ für ein $\lambda \in \R$. Überlegen
    Sie sich, dass Sie durch Substitution sogar die Form
    \begin{align*}
      \tilde{y}^{\prime}=\tilde{f}(\tilde{y})
    \end{align*}
    erhalten können.

    \item[b)] Geben Sie für den Fall $\det A \neq 0$ eine Funktion $\tilde{f}$ an,
    die das Gewünschte leistet. Hinweis: betrachten Sie die Lösung $(t_0 , y_0 )$
    von
    \begin{align*}
      A\left(
      \begin{array}{c}
        y_0 \\
        t_0
      \end{array}
      \right) = -\left(
      \begin{array}{c}
        c \\
        \gamma
      \end{array}
      \right)
    \end{align*}
    Zeigen Sie, dass dann die Funktion $\tilde{y}(t) := y(t + t_0 ) - y_0$ eine
    ODE der Form \eqref{allgemeiner Typ} mit $c = \gamma = 0$ erfüllt. Überlegen
    Sie sich, dass letztere Form einfach auf die Form einer homogenen ODE gebracht
    werden kann.
  \end{itemize}
\end{exercise}

\begin{solution}
\begin{itemize}
  \item[a)]
  Da $\det(A) = 0$, gilt
  \begin{align*}
    \exists \lambda \in \R: (a,b) = \lambda (\alpha, \beta) \lor \lambda (a,b) = (\alpha, \beta)
  \end{align*}
  Sei o.B.d.A. $(a,b) = \lambda (\alpha, \beta)$, also auch $ay + bt = \lambda (\alpha y + \beta t)$.

  Sei $\tilde{y}(t) = \alpha y(t) + \beta t$
  \begin{align*}
    \Rightarrow \tilde{y}'(t) = \alpha y'(t) + \beta = \alpha f\left(\frac{ay + bt + c}{\alpha y + \beta t + \gamma}\right) = \alpha
    f\left(\frac{\lambda \tilde{y} + c}{\tilde{y} + \gamma}\right) + \beta =: \tilde{f}(\tilde{y})
  \end{align*}

  \item[b)]
  \begin{align*}
  \left(
    \begin{array}{cc}
      a & b \\
      \alpha & \beta
    \end{array}
  \right)\left(
    \begin{array}{c}
      y_0 \\
      t_0
    \end{array}
    \right) = -\left(
    \begin{array}{c}
      c \\
      \gamma
    \end{array}
    \right) \\
    \Rightarrow ay_0 + bt_0 = -c \land \alpha y_0 + \beta t_0 = -\gamma
  \end{align*}
  Sei nun $\tilde{y}(t) := y(t + t_0 ) - y_0$
  \begin{align*}
    \tilde{y}'(t) = y'(t + t_0 ) = f \bigg(\frac{ay(t+t_0) + b(t+t_0) + c}{\alpha y(t+t_0) + \beta (t+t_0) + \gamma}\bigg) = f\bigg(\frac{ay(t+t_0) - ay_0 + b(t+t_0) - bt_0}{\alpha y(t+t_0) -\alpha y_0 + \beta (t+t_0) - \beta t_0}
    \bigg) = f \bigg(\frac{a\tilde{y}(t) + bt}{\alpha \tilde{y}(t) + \beta t}\bigg)
  \end{align*}
  Nochmals vereinfacht also
  \begin{align*}
    \tilde{y}'(t) = f \bigg(\frac{a\tilde{y}(t)/t + b}{\alpha \tilde{y}(t)/t + \beta }\bigg)
  \end{align*}
  Sei nun $u = \tilde{y}/t$

  \begin{align*}
    &\Rightarrow u' = \frac{\tilde{y}' t - \tilde{y}}{t^{2}} = \frac{\tilde{y}'}{t} - \frac{\tilde{y}}{t^{2}} = \frac{\tilde{y}'- u}{t} \\
    &\Rightarrow u' = \frac{1}{t} \left(f \bigg(\frac{au + b}{\alpha u + \beta }\bigg) - u\right) =: \frac{1}{t} \hat{f}(u)
  \end{align*}
\end{itemize}
\end{solution}

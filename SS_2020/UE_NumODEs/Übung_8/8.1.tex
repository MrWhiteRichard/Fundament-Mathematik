\begin{exercise}
Konstruieren Sie ein Adamsverfahren mit $k = 2, s = 1$ und $r = 0$ und variablen
Schrittweiten $h_j := t_j - t_{j-1}$ der Form
\begin{align}
  y_{i+1} = y_i + \sum_{j=0}^2 \beta_{i,j}(h_{i-1},h_i,h_{i+1})f_{i-j},
  \qquad f_{i-j} := f(t_{i-j},y_{i-j}).
\end{align}
Zur Bestimmung der Konstanten $\beta_{i,j}$ können Sie ein Computeralgebrasystem
verwenden. Vergleichen Sie Ihr Verfahren mit den Werten aus dem Vorlesungsskript
für äquidistante Schrittweiten.
\end{exercise}
\begin{solution}
Die Anzahl der Schritte $m$ dieses Verfahrens ist $m = \max\{r+1,s+k\}=\min\{1,3\} = 3$.
Eine allgemeine lineare $k$-Schrittmethode hat die Form
\begin{align*}
  \sum_{j = 0}^k \alpha_{k - j}y_{i+1-j} = h \sum_{j = 0}^k \beta_{i,j}f_{i-j}.
\end{align*}
In unserem Fall ergibt das
\begin{align*}
  \alpha_3 y_{i + 1} + \alpha_2 y_{i} + \alpha_1 y_{i - 1} + \alpha_0 y_{i - 2} =
  h \left(\beta_{i,0} f_{i+1} +
  \beta_{i,1} f_{i} +
  \beta_{i,2} f_{i-1} +
  \beta_{i,3} f_{i-2}\right),
\end{align*}
wobei bei Adamsverfahren $\alpha_{m-j} = 0$ für $j \in \{0,\dots,m-1\}\backslash\{r+1\}$,
$\alpha_m = 1, \alpha_{m-r-1} = -1$ gilt. \\
Ebenso gilt $\beta_{i,j} = 0$ für $j \in \{0,\dots,s-1\}$.
Also vereinfacht sich der Ausdruck zu
\begin{align*}
y_{i + 1} - y_{i} =
h \left(
\beta_{i,1} f_{i}. +
\beta_{i,2} f_{i-1}. +
\beta_{i,3} f_{i-2}.\right),
\end{align*}
wobei man die $b_j$ durch Integration der entsprechenden Lagrange-Interpolationspolynome erhält. \\

----------------------- \\

Wir machen die Konstruktion analog zum Skript. Für $r=0$ haben wir Also

\begin{align*}
  y(t_{i+1}) = y(t_i) + \int_{t_i}^{t_{i+1}} f(\tau, y(\tau))d\tau
\end{align*}

Nun interpolieren wir die Funktion $f$ an den $k+1$ Stützstellen

\begin{align*}
  t_{i-j}, \quad j=0,1,2
\end{align*}

Dann ist unser interpolierendes Polynom gegeben durch

\begin{align*}
  p = \sum_{j=0}^2 f_{i-j}L_j, \quad \text{mit } L_j(t) := \prod_{\stackrel{m = 0}{m \neq j}}^{2}
  \frac{t - t_{i - m}}{t_{i - j} - t_{i - m}}
\end{align*}

Dann erhalten wir die Form wie in der Angabe.
\begin{align*}
  y_{i+1} = y_i + \sum_{j=0}^2 \beta_{i,j}(h_{i-1},h_i,h_{i+1})f_{i-j},
  \qquad f_{i-j} := f(t_{i-j},y_{i-j}).
\end{align*}


Wobei wir unsere $\beta_{i,j}(h_{i-1},h_i,h_{i+1})$ erhalten durch die Integration der Lagrangebasispolynome

\begin{align*}
  \beta_{i,j} = \int_{t_{i}}^{t_{i + 1}} \prod_{\stackrel{m = 0}{m \neq j}}^{2}
  \frac{t - t_{i - m}}{t_{i - j} - t_{i - m}}dt \\
\end{align*}

Wir berechnen

\begin{align*}
  \beta_{i,1}(h_{i-1},h_i,h_{i+1}) &= \int_{t_i}^{t_{i + 1}}
  \frac{t - t_{i - 1}}{t_{i} - t_{i - 1}}\frac{t - t_{i - 2}}{t_{i} - t_{i - 2}}dt
  = \int_{0}^{h_{i+1}}
  \frac{t + h_i}{h_i}\frac{t + h_i + h_{i-1}}{h_i + h_{i-1}}dt \\
  &= \frac{h_{i+1}(3h_{i+1}(h_{i-1} + 2h_i) + 6h_i(h_{i-1} + h_i) + 2h_{i+1}^2)}{6h_i(h_{i-1} + h_i)}\\
  \beta_{i,2}(h_{i-1},h_i,h_{i+1}) &= \int_{t_i}^{t_{i + 1}}
  \frac{t - t_{i}}{t_{i - 1} - t_{i}}\frac{t - t_{i - 2}}{t_{i - 1} - t_{i - 2}}dt
  = -\int_{0}^{h_{i+1}}
  \frac{t}{h_i}\frac{t + h_i + h_{i-1}}{h_{i-1}}dt \\
  &= -\frac{h_{i+1}^2(3h_{i-1} + 3h_i + 2h_{i+1})}{6h_{i-1}h_i} \\
  \beta_{i,3}(h_{i-1},h_i,h_{i+1}) &= \int_{t_i}^{t_{i + 1}}
  \frac{t - t_{i}}{t_{i - 2} - t_{i}}\frac{t - t_{i - 1}}{t_{i-2} - t_{i - 1}}dt
  = \int_{0}^{h_{i+1}}
  \frac{t}{h_i + h_{i-1}}\frac{t + h_{i-1}}{h_{i-1}}dt\\
  &= \frac{h_{i+1}^2(3h_{i-1} + 2h_{i+1})}{6h_{i-1}(h_{i-1} + h_i)}
\end{align*}
Also lautet unser Adamsverfahren
\begin{align*}
  y_{i+1} &= y_i +
  \frac{h_{i+1}(3h_{i+1}(h_{i-1} + 2h_i) + 6h_i(h_{i-1} + h_i) + 2h_{i+1}^2)}{6h_i(h_{i-1} + h_i)}
  f_i \\
  &-\frac{h_{i+1}^2(3h_{i-1} + 3h_i + 2h_{i+1})}{6h_{i-1}h_i}f_{i-1} +
  \frac{h_{i+1}^2(3h_{i-1} + 2h_{i+1})}{6h_{i-1}(h_{i-1} + h_i)}f_{i-2}
\end{align*}
Setzen wir die Schrittweiten $h_{i-1} = h_i = h_{i+1} =: h$ konstant, erhält man mit
\begin{align*}
  \beta_{i,0}(h) = \frac{23}{12}h \\
  \beta_{i,1}(h) = -\frac{16}{12}h \\
  \beta_{i,2}(h) = \frac{5}{12}h \\
\end{align*}
wieder die Adams-Bashforth-Methode mit konstanter Schrittweite $h$.
\end{solution}

\begin{exercise}
Verallgemeinern Sie den Beweis von Theorem 5.35 des Skriptums für den allgemeinen
Fall $n \in \N$. Dazu müssen Sie im Wesentlichen folgendes zeigen:
\begin{enumerate}[label = \textbf{\alph*)}]
  \item Mit den angepassten Definitionen aus dem Skript gilt
  \begin{align}
    E_{\ell + 1} = \left(A_{\rho}^{\top} \otimes I\right)E_{\ell} + F_{\ell},
  \end{align}
  wobei $I \in \R^{n \times n}$ die Einheitsmatrix und $A \otimes B$ das Kroneckerprodukt
  zweier Matrizen $A \in \R^{k \times k}$ und $B \in \R^{n \times n}$ ist, also
  \begin{align}
    A \otimes B := \begin{pmatrix}
      A_{11}B & \hdots & A_{1k}B \\
      \vdots & & \vdots \\
      A_{k1}B & \hdots & A_{kk}B
    \end{pmatrix}
    \in \R^{kn \times kn}.
  \end{align}
  \item Aus der Wurzelbedingung folgt
  \begin{align}
    \sup_{k \in \N_0} \left\| (A_{\rho}^{\top} \otimes I)^k\right\|_{\infty} < \infty.
  \end{align}
\end{enumerate}
Sie müssen auch erklären können, warum dies die beiden wesentlichen Änderungen
zum skalaren Fall sind!
\end{exercise}
\begin{solution}
Wir schreiben wieder den Fehler $e_{\ell} = y(t_{\ell}) - y_{\ell} \in \R^n, \ell = 0,\dots,N$ um als
\begin{align*}
  E_{\ell} := \begin{pmatrix}
    e_{\ell - k + 1} \\
    \vdots \\
    e_{\ell}
  \end{pmatrix}
  \in R^{kn}
\end{align*}
Analog zum Beweis im Skript erhalten wir mit
$\delta_{\ell} := \Phi(t_{\ell},y(t_{\ell + 1},\dots,y(t_{\ell+1-k}),h) -
\Phi(t_{\ell},y_{\ell + 1},\dots,y_{\ell+1-k},h)$
\begin{align*}
  e_{\ell + 1} = h\delta_{\ell} - \eta_{\ell}(y,h) - \sum_{j = 1}^k \alpha_{k - j}e_{\ell + 1 - j} \in \R^n.
\end{align*}
Also gilt mit $F_{\ell} := (0,\dots,0,h\delta_{\ell} - \eta_{\ell}(y,h)) \in \R^{nk}$
\begin{align*}
  E_{\ell + 1} = \begin{pmatrix}
    0_n & I_n & 0_n & \hdots & 0_n \\
    \vdots & \ddots & I_n & \hdots & 0_n\\
    \vdots &  & \ddots & \ddots & 0_n \\
    0_n & \hdots & \hdots & 0_n & I_n \\
    -\alpha_0I_n & \hdots & \hdots & \hdots & -\alpha_{k-1}I_n
  \end{pmatrix}E_{\ell} + F_{\ell}.
\end{align*}
Wieder analog zum Skript folgt
\begin{align*}
  E_{\ell + k - 1} =  \left(A_{\rho}^{\top} \otimes I\right)^{\ell}E_{k-1}
  + \sum_{j = 0}^{\ell - 1}\left(A_{\rho}^{\top} \otimes I\right)^{\ell - j - 1}F_{j + k - 1},
  \qquad \ell = 0,\dots,N-k+1.
\end{align*}
Die Schranke für $\|F_{\ell + k - 1}\|_{\infty}$ geht im mehr-dimensionalen
genauso wie im Skript durch.
Im dritten Schritt müssen wir wieder etwas anpassen. Wir definieren
\begin{align*}
  M := \sup_{k \in \N_0} \left\| (A_{\rho}^{\top} \otimes I)^k\right\|_{\infty}
\end{align*}
Laut Lemma 5.32. ist $M < \infty$ äquivalent zu $\rho((A_{\rho}^{\top} \otimes I_n) \leq 1$
und alle $\lambda \in \sigma(A)$ mit $|\lambda| = 1$ sind halbeinfach.
Wir wissen, dass
\begin{align*}
  \sigma(A_{\rho}^{\top} \otimes I_n) = \sigma(A_{\rho}^{\top} \otimes I_n)^{\top}
  = \sigma(A_{\rho} \otimes I_n)
\end{align*}
Zur Berechnung des zugehörigen charakteristischen Polynoms betrachte
\begin{align*}
\lambda I_{nk} - A_{\rho} \otimes I_n = \begin{pmatrix}
\lambda I_n & \hdots & \hdots & 0_n & \alpha_0I_n \\
-I_n & \ddots & & \vdots & \alpha_1I_n \\
0_n & -I_n & \ddots & \vdots & \vdots \\
\vdots & \ddots & \ddots & \lambda I_n & \alpha_{k-2}I_n \\
0_n & \hdots & 0_n & -I_n & (\lambda-  \alpha_{k-1})I_n
\end{pmatrix}.
\end{align*}
Jetzt können wir Zeilenumformungen durchführen
(wir addieren $\nicefrac{1}{\lambda}$ mal die $i$-te Zeile zur $n+i$-ten Zeie dazu, $i = 1,\dots,n(k-1)$), welche die Determinante der
Matrix nicht verändern und erhalten
\begin{align*}
  \lambda I_{nk} - A_{\rho} \otimes I_n \leadsto
  \begin{pmatrix}
  \lambda I_n & \hdots & \hdots & 0_n & \alpha_0I_n \\
  0_n & \ddots & & \vdots & * \\
  0_n & 0_n & \ddots & \vdots & \vdots \\
  \vdots & \ddots & \ddots & \lambda I_n & * \\
  0_n & \hdots & 0_n & 0_n & (\frac{\lambda^k + \sum_{i = 0}^{k-1}\alpha_i\lambda^i}{\lambda})I_n
  \end{pmatrix}
\end{align*}
Davon können wir die Determinante berechnen und erhalten
\begin{align*}
  \chi_{A_{\rho} \otimes I}(\lambda) =
  \left(\lambda^k + \sum_{i = 0}^{k-1}\alpha_i\lambda^i\right)^n.
\end{align*}
Damit sind die Eigenwerte also genau die Nullstellen von
\begin{align*}
  \lambda^k + \sum_{i = 0}^{k-1}\alpha_i\lambda^i
\end{align*}
mit $n$-facher Vielfachheit. Aus der Wurzelbedingung folgt damit direkt, dass
$\sigma(A_{\rho} \otimes I) \leq 1$. Alle Nullstellen mit $|\lambda| = 1$
sind jetzt aber nicht mehr einfach, sondern haben Vielfachheit $n$.
Betrachte den dazugehörigen Eigenvektor $v = (v_1,\dots,v_k)^{\top}$ zu $\lambda$ von der Matrix $A_{\rho}$ aus dem Skript.
Man sieht ein, dass dann die Vektoren
\begin{align*}
  v^i := (\underbrace{0,\dots,0}_{i -1 \text{viele}},v_1,\underbrace{0,\dots,0}_{n - 1 \text{viele}},
  v_2,0,\dots,0,v_k,\underbrace{0,\dots,0}_{n -i \text{viele}})^{\top} \in \R^{nk}, \qquad i = 1,\dots,n
\end{align*}
Eigenvektoren zu $\lambda$ der Matrix $A_{\rho} \otimes I_n$ bilden und daher
$\lambda$ halbeinfach ist. Damit foglt aus Lemma 5.32 $M < \infty$ und jetzt können
wir die weiteren Rechnungen aus Schritt 3 des Skripts analog nachrechnen.
Im letzten Schritt müssen wir nur noch $\|e_{\ell}\|$ abschätzen.
Das geht wieder analog zum Skript, wenn wir $|e_{\ell + k  - 1}|$
durch $\|e_{\ell + k  - 1}\|_{\infty}$ ersetzen.
\end{solution}

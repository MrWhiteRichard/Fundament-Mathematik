\begin{exercise}
  Sei $f \in C^1(\R^{2d},\R^{2d})$ die rechte Seite des autonomen Systems
  \begin{align}\label{aut}
    \begin{pmatrix}
      p^{\prime} \\ q^{\prime}
    \end{pmatrix} = f(p,q).
  \end{align}
  Weiters sei die Abbildung $R$ definiert durch
  \begin{align}
    R(p,q) = \begin{pmatrix}
      -p \\ q
    \end{pmatrix}.
  \end{align}
  Es gelte außerdem
  \begin{align}\label{rf}
    R \circ f = -f \circ R.
  \end{align}
  \begin{enumerate}[label = \textbf{\alph*)}]
    \item Zeigen Sie, dass für den kontinuierlichen Fluss $\Phi^t$ von \eqref{aut}
    gilt, dass
    \begin{align*}
      R \circ \Phi^t = \Phi^{-t} \circ R.
    \end{align*}
    \item Zeigen Sie, dass für den diskreten Fluss $\Psi^h$ eines Runge-Kutta-Verfahrens angewandt auf \eqref{aut} gilt, dass
    \begin{align*}
      R \circ \Psi^h = \Psi^{-h} \circ R.
    \end{align*}
    \item Sei $M$ eine symmetrisch, positiv definite Matrix, $U$ eine zweimal
    stetig differenzierbare Funktion und $H$ eine Hamilton-Funktion mit
    \begin{align*}
      H(p,q) := \frac{1}{2}p^{\top}M^{-1}p + U(q).
    \end{align*}
    Zeigen Sie, dass die Funktion $f$ des zugehörigen Hamilton-Systems \eqref{rf}
    erfüllt.
  \end{enumerate}
\end{exercise}

\begin{solution}
\leavevmode \\
\begin{enumerate}[label = \textbf{\alph*)}]
  \item Sei $y_0 := (p_0,q_0)^{\top}$, laut Definition ist $\Phi^t(y_0) := y_{y_0}(t)$. Es gilt
    \begin{align*}
      R \circ \Phi^t(y_0) &= R(y_{y_0}(t)) = R\left(
      \begin{pmatrix}
        p_0 \\ q_0
      \end{pmatrix}
      + \int_0^t f(p_{y_0}(\tau),q_{y_0}(\tau)) d\tau\right)
      = R\left(
      \begin{pmatrix}
        p_0 \\ q_0
      \end{pmatrix}\right)
      + \int_0^t R\circ f(p_{y_0}(\tau),q_{y_0}(\tau)) d\tau\\
      &= \begin{pmatrix}
        -p_0 \\ q_0
      \end{pmatrix}
      - \int_0^t f\circ R(p_{y_0}(\tau),q_{y_0}(\tau)) d\tau
      = \begin{pmatrix}
        -p_0 \\ q_0
      \end{pmatrix}
      + \int_0^{-t} f\circ R(p_{y_0}(-\tau),q_{y_0}(-\tau)) d\tau
    \end{align*}
    Wir definieren nun $\widetilde{y}(t) := R(p_{y_0}(t),q_{y_0}(t))$
    \begin{align*}
      \widetilde{y}^{\prime}(t) = R(p_{y_0}(-t),q_{y_0}(-t))^{\prime} &=
      -R(f(p_{y_0}(-t),q_{y_0}(-t)))
      = f(R(p_{y_0}(-t),q_{y_0}(-t))) = f(\widetilde{y}(t))\\
      R(p_{y_0}(0),q_{y_0}(0)) &= (-p_0,q_0)^{\top}.
    \end{align*}
    Also ist $\widetilde{y}(t) = y_{R(y_0)}(t)$ die Lösung des Anfangswertproblems mit Startwert
    $(-p_0,q_0)$ und es gilt
    \begin{align*}
      R \circ \Phi^t(y_0) &= \begin{pmatrix}
        -p_0 \\ q_0
      \end{pmatrix}
      + \int_0^{-t} f\circ R(p_{y_0}(-\tau),q_{y_0}(-\tau)) d\tau
      = \begin{pmatrix}
        -p_0 \\ q_0
      \end{pmatrix}
      + \int_0^{-t} f\circ y_{R(y_0)}(\tau) d\tau \\
      &= y_{R(y_0)}(-t) = \Phi^{-t} \circ R(y_0).
    \end{align*}
  \item
  Seien $\Psi^h(y_0) = y_0 + h\sum_{k=1}^mb_jk_j$ und $\Psi^{-h}(R(y_0)) = R(y_0) - h\sum_{k=1}^mb_j\widetilde{k}_j$.
  Dann gilt
  \begin{align*}
    \max_{j=1,\dots,m}\|\widetilde{k}_j + R(k_j)\| &= \max_{j=1,\dots,m}
    \|f(R(y_0) - h\sum_{\ell = 1}^m A_{j\ell}\widetilde{k}_{\ell}) +
    R(f(y_0 + h\sum_{\ell = 1}^m A_{j\ell}k_{\ell}))\| \\
    &= \max_{j=1,\dots,m}\|f(R(y_0) + h\sum_{\ell = 1}^m A_{j\ell}\widetilde{k}_{\ell}))
    - f(R(y_0)) + h\sum_{\ell = 1}^m A_{j\ell}R(k_{\ell}))\| \\
    &\leq \max_{j=1,\dots,m}L\|h\sum_{\ell = 1}^m A_{j\ell}\widetilde{k}_{\ell} + A_{j\ell}R(k_{\ell})\| \\
    &\leq \max_{j=1,\dots,m}Lh\sum_{\ell = 1}^m |A_{j\ell}|\|\sum_{\ell = 1}^m\widetilde{k}_{\ell} + R(k_{\ell})\|
    < \max_{j=1,\dots,m}\|\sum_{\ell = 1}^m\widetilde{k}_{\ell} + R(k_{\ell})\| \text{ für $h$ hinreichend klein.}
  \end{align*}
  Also folgt für $j = 1,\dots,m: -\widetilde{k}_j = R(k_j)$. Damit berechnen wir
  \begin{align*}
    R \circ \Psi^h(y_0) = R(y_0 + h\sum_{k=1}^mb_jk_j)
    = R(y_0) + h\sum_{k=1}^mb_jR(k_j) = R(y_0) - h\sum_{k=1}^mb_j\widetilde{k}_j
    = \Psi^{-h}(R(y_0)).
  \end{align*}
  \item Wenn $M$ symmetrisch positiv definit ist, dann auch $M^{-1}$
  \begin{align*}
    f(p,q) = \begin{pmatrix}
      -\nabla_q H(p,q) \\ \nabla_p H(p,q)
    \end{pmatrix}
    = \begin{pmatrix}
      -\nabla U(q) \\ \frac{1}{2}(M^{-1}p + p^{\top}M^{-1})
    \end{pmatrix}
    = \begin{pmatrix}
      -\nabla U(q) \\ M^{-1}p
    \end{pmatrix}.
  \end{align*}
  Damit gilt nun
  \begin{align*}
    R\circ f (p,q) = \begin{pmatrix}
      \nabla U(q) \\ M^{-1}p
    \end{pmatrix}
    = - \begin{pmatrix}
      -\nabla U(q) \\ M^{-1}(-p)
    \end{pmatrix}
    = -f(-p,q) = -f\circ R(p,q).
  \end{align*}
\end{enumerate}

\end{solution}

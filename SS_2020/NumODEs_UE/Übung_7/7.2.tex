\begin{exercise}
  Wir verwenden die implizite Trapezregel aus Exa. 3.6.

  \begin{itemize}
    \item[\textbf{a)}] Zeigen Sie, dass sie die gleiche Stabilitätsfunktion wie
    die implizite Mittelpunktsregel aus Exa. 3.5 besitzt.
    \item[\textbf{b)}] Zeigen Sie, dass die implizite Trapezregel A stabil ist.
    \item[\textbf{c)}] Zeigen Sie, dass die implizite Trapezregel nicht B stabil ist.
  \end{itemize}
  Hinweis: Zeigen Sie zunächst, dass die Funktion

  \begin{align}
    f(y) := \begin{cases}
      -y^3, & y \leq 0 \\
      -y^2, & y > 0
  \end{cases}
  \end{align}

  dissipativ ist. Wenden Sie dann die implizite Trapezregel auf ein Anfangswertproblem
  mit dieser rechten Seite und den Anfangswerten $y_0 = 0$ bzw. $\tilde{y}_0$ an.
  Verwenden Sie z.B. die Schrittweite $h=1$ und finden Sie dann ein $\tilde{y}_0 <0$ sodass
  $\tilde{y}_1 > - \tilde{y}_0$.
\end{exercise}

\begin{solution}
 \begin{itemize}
   \item[\textbf{a)}]Wir sehen uns die Butcher-Schemata der Methoden an:

    \begin{align*}
      \begin{array}{c|cc}
        0 & 0 & 0 \\
        1 & \nfrac{1}{2} & \nfrac{1}{2} \\
        \hline
        & \nfrac{1}{2} & \nfrac{1}{2}
      \end{array}
      \quad
      \begin{array}{c|c}
        \nfrac{1}{2} & \nfrac{1}{2} \\
        \hline
        & 1
      \end{array}
    \end{align*}

    Wobei das linke das der impliziten Trapezregel und das rechte das der Mittelpunktsregel ist.
    Nach Theorem 4.10 ist die Stabilitätsfunktion für ein $m-$stufiges Runge-Kutta
    Verfahren gegeben durch:

    \begin{align*}
      R(z) = 1 +zb^T (I- zA)^{-1} \1, \quad \text{where} \quad \1 =(1,...,1)^T
      \in \R^m
    \end{align*}

    Damit sehen wir, dass die Stabilitätsfunktion der impliziten Mittelpunktsregel

    \begin{align*}
        R(z) = 1 + z\left(1- \frac{z}{2}\right) = 1+z \frac{2}{2-z}
    \end{align*}

    ist. Berechnen wir nun also die der impliziten Trapezregel.

    \begin{align*}
      R(z) =& 1 +z\Big(\frac{1}{2}, \frac{1}{2}\Big) \left(
      \begin{array}{cc}
        1 & 0 \\
        -\frac{z}{2} & 1- \frac{z}{2}
      \end{array}
      \right)^{-1}
      \1 \\
      =& 1 +z \Big(\frac{1}{2}, \frac{1}{2}\Big) \left(
      \begin{array}{cc}
        1 & 0 \\
        \frac{z}{-z+2} & \frac{2}{-z+2}
      \end{array}
      \right)
      \1 = 1+z\Big(\frac{1}{2},\frac{1}{2}\Big) \left(
      \begin{array}{c}
        1 \\
        -1+\frac{4}{2-z}
      \end{array}
      \right) = 1+z\frac{2}{2-z}
    \end{align*}

    Also sind die Stabilitätsfunktionen wirklich die selben.

  \item[\textbf{b)}] Um die A Stabilität zu zeigen, müssen wir

    \begin{align*}
      \sup\limits_{\Re(z) \leq 0} \vbraces{R(z)} \leq 1
    \end{align*}
    zeigen.
    Sei also $z \in \C, z=a+ ib$ mit $a \leq 0$. Wir rechnen nach:

    \begin{align*}
      R(z) = \vbraces{1+\frac{2(a+ib)}{2-a-ib}} = \vbraces{\frac{2-a-ib +2a +2ib}{2-a-ib}}
      = \frac{\vbraces{2+a+ib}}{\vbraces{2-a-ib}}
      = \frac{\sqrt{a^2 +4a +4 +b^2}}{\sqrt{a^2-4a+4+b^2}}
    \end{align*}
    und aufgrund $a^2 + 4a +4 +b^2 \leq a^2 -4a +4+b^2$ gilt
    \begin{align*}
      R(z) \leq 1.
    \end{align*}
  \item[\textbf{c)}] Wir zeigen zuerst, dass die Funktion dissipativ ist. Das ist für
    eine reellwertige Funktion genau dann der Fall, wenn sie monoton fallend ist. Dazu
    berachten wir die Ableitung, wobei wir den Differenzialquotienten in $y=0$  gesondert betrachten.
    \begin{align*}
    \lim\limits_{t \rightarrow 0^+} \frac{f(t)}{t} = 0 \quad
    \lim\limits_{t \rightarrow 0^-} \frac{f(t)}{t} = 0
    \end{align*}
    Also gilt
    \begin{align*}
      f^\prime (y) = \begin{cases}
      -3 y^2 , & y \leq 0 \\
      -2 y, & y > 0
    \end{cases}.
    \end{align*}

    Also ist die Funktion monoton fallend und damit auch dissipativ. Wollen wir nun
    den Rest des Hinweises nachvollziehen sehen wir uns die Definition von B Stabilität
    an. Diese besagt, dass für alle dissipativen $f \in C(\R^n ,\R^n )$ und für alle
    zulässigen $h$, sodass das Einschrittverfahren wohldefiniert ist gilt:

    \begin{align*}
      \forall t_0 \in \R \quad \forall y_0 , \tilde{y}_0 \in \R^n : \quad
      \norm{y_1 - \tilde{y}_1} \leq \norm{y_0 - \tilde{y}_0}
    \end{align*}

    Nun wenden wir einen Schritt der impliziten Trapezregel auf $y_0 = 0$ an.
    \begin{itemize}
      \item[Fall 1: $y_1 > 0$:] Dann gilt

        \begin{align*}
          y_1 = y_0 + \frac{f(t_0,y_0) + f(t_1,y_1)}{2} = \frac{f(y_1)}{2} \Leftrightarrow y_1 = -\frac{y_1^2}{2}
          \Leftrightarrow y_1^2 + 2y_1 = 0 \Leftrightarrow y_1 = -1 \pm 1 \leq 0.
        \end{align*}
        Also existieren keine positiven Lösungen.
      \item[Fall 2: $y_1 \leq 0$:] Dann gilt

      \begin{align*}
        y_1 = - \frac{y_1^3}{2} \Leftrightarrow y_1^3 +2y_1 = 0 \Leftrightarrow
        y_1(y_1^2+2)=0.
      \end{align*}
      Damit ist die einzige reelle Lösung $y_1 = 0$.
    \end{itemize}
    Um zu zeigen, dass die implizite Trapezregel nicht B-stabil ist, müssen wir
    also $\widetilde{y}_0$ finden, sodass

    \begin{align*}
    |\widetilde{y}_0| = ||y_0 - \widetilde{y}_0|| < ||y_1 - \widetilde{y}_1|| = |\widetilde{y}_1|
    \end{align*}

    Damit sehen wir auch warum es genügt den Hinweis zu zeigen. Damit berechnen wir
    unter der Voraussetzung $\tilde{y}_1 > 0$:
    \begin{align*}
      \tilde{y}_1 = \tilde{y}_0 - \frac{\tilde{y}_0^3 +\tilde{y}_1^2}{2} \Leftrightarrow
      \tilde{y}_1^2 - 2\tilde{y}_1 - \tilde{y}_0^3+2\tilde{y}_0 = 0
    \end{align*}

    Wählen wir nun $\tilde{y}_0 = -1$ so ergibt das Lösen der quadratischen Gleichung:

    \begin{align*}
      \tilde{y}_1 = 1 \pm \sqrt{2}
    \end{align*}
    Wobei nach Annahme nur $\tilde{y}_1 = 1+ \sqrt{2}$ zulässig ist. Damit gilt auch:

    \begin{align*}
      |\tilde{y}_1| > 1 = |\tilde{y}_0|
    \end{align*}

    Also ist das Verfahren nicht B-Stabil und wir sehen damit, dass aus A-Stabilität
    im Allgemeinen nicht B-Stabilität folgt (wobei die Umkehrung ja gilt).
 \end{itemize}
\end{solution}

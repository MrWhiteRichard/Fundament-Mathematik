\begin{exercise}
  Ein explizites Runge-Kutta-Verfahren wurde in $(2.27)$ und $(2.28)$ im Skript
  definiert. Für ein implizites Runge-Kutta-Verfahren wird die Gleichung in
  $(2.28)$ ersetzt durch

  \begin{align} \label{R-K_impl}
    k_i = f \Bigg( t + c_ih, y + h\sum_{j=1}^m A_{ij} k_j
    \Bigg),\text{ } i=1,\ldots, m
  \end{align}

  Die Matrix $A$ ist dabei keine strikte untere Dreiecksmatrix mehr sondern eine
  vollbesetzte Matrix.

  Verallgemeinern Sie Theorem $2.27$ auf implizite Runge-Kutta-Verfahren. Beweisen
  Sie dazu, dass solche Verfahren in dem dortigen Sinne stabil sind.

  Hinweis: Sie dürfen annehmen, dass das implizite Runge-Kutta-Verfahren eindeutig
  durchführbar ist. Diese Frage ist nicht trivial, da $(\ref{R-K_impl})$ ein
  nichtlineares Gleichungssystem ist.
\end{exercise}

\begin{solution}
Theorem 2.27 für implizite Runge-Kutta Verfahren

Sei

\begin{align*}
  \begin{array}{c|c}
    c & A \\
    \hline
    & b^{T}
  \end{array}
\end{align*}

ein (implizites) m-stufiges Runge-Kutta Verfahren. Sei außerdem L die Lipschitz Konstante von $f$ in $y$ und
\begin{align*}
  h_{max} := \text{max}\Bbraces{h>0|\forall i \in \Bbraces{1,...,m}:h<\frac{1}{L\sum_{j=1}^{m}|A_{ij}|}}
\end{align*}
Dann existiert ein $C_{\text{Stab}} > 0$, sodass

\begin{align*}
  \forall t \in [t_{0},T) \forall h \in (0,\text{min}\{T-t,h_{max}\}] \forall y, \tilde(y) \in \R^{n} : \|\phi(t,y,h) - \phi(t,\tilde{y},h)\| \leq C_{\text{Stab}} \|y-\tilde{y}\|
\end{align*}

Beweis:

Wie im Beweis von 2.27 betrachten wir zunächst die Differenzen der Inkremente $k_{i}$ und $\tilde{k_{i}}$ von $y$ und $\tilde{y}$.

Gemäß Angabe ist das Verfahren durchführbar und somit auch für alle $i \in \{1,...,m\}$ die $k_{i}$ wohldefiniert.
Somit kann man sich ein $i_{1}$ definieren mit

\begin{align}\label{iVoraussetzung}
  \forall i\in \{1,...,m\}: \|k_{i}-\tilde{k_{i}}\| \leq \|k_{i_{1}}-\tilde{k_{i_{1}}}\|
\end{align}

analog definieren wir $i_{l}, l=2,...,m$ sodass die Ugleichung \eqref{iVoraussetzung} gilt $\forall i\in \{1,...,m\}\setminus \{i_{1},...,i_{l-1}\}$.

Wir wollen zeigen mit Induktion nach $l=1,...,m$, dass
\begin{align}\label{ind}
  \exists C_{l}>0: \|k_{i_{l}}-\tilde{k_{i_{l}}}\| \leq C_{l} \|y-\tilde{y}\|
\end{align}
Nun gilt also zunächst für $l=1$ durch die Lipschitzstetigkeit von $f$:

\begin{align*}
  \|k_{i_{1}}-\tilde{k_{i_{1}}}\| =& \|f(t+c_{i}h,y+h\sum_{j=1}^{m}A_{i_{1}j}k_{j})-f(t+c_{i}h,\tilde{y}+h\sum_{j=1}^{m}A_{i_{1}j}\tilde{k_{j}})\| \\
  \leq& L\|(h\sum_{j=1}^{m}A_{i_{1}j}k_{j}-h\sum_{j=1}^{m}A_{i_{1}j}\tilde{k_{j}}) + (y-\tilde{y})\| \\
  \leq& Lh \|\sum_{j=1}^{m}A_{i_{1}i_{j}}(k_{i_{j}}-\tilde{k_{i_{j}}})\| + L\|y-\tilde{y}\|
\end{align*}

mit dieser Ungleichung und der Wahl von $i_{1}$ gilt also

\begin{align*}
  \|k_{i_{1}}-\tilde{k_{i_{1}}}\| &\leq Lh \sum_{j=1}^{m}|A_{i_{1}i_{j}}|\cdot\|k_{i_{j}}-\tilde{k_{i_{j}}}\| + L\|y-\tilde{y}\| \\
  &\leq Lh\sum_{j=1}^{m}|A_{i_{1}i_{j}}| \cdot \|k_{i_{1}}-\tilde{k_{i_{1}}}\| + L\|y-\tilde{y}\| \\
  &\Rightarrow  \|k_{i_{1}}-\tilde{k_{i_{1}}}\| \underbrace{(1-Lh\sum_{j=1}^{m}|A_{i_{1}i_{j}}|)}_{>0 \text{,~da h hinreichend klein}} \leq L\|y-\tilde{y}\| \\
  &\Rightarrow  \|k_{i_{1}}-\tilde{k_{i_{1}}}\|  \leq \frac{L}{1-Lh\sum_{j=1}^{m}|A_{i_{1}i_{j}}|}\|y-\tilde{y}\| \leq  \underbrace{\frac{L}{1-Lh_{\max}\sum_{j=1}^{m}|A_{i_{1}i_{j}}|}}_{=:C_{1}} \|y-\tilde{y}\|
\end{align*}

Sei also $l \in \{2,...,m\}$ beliebig und für alle $k<l$ die Ungleichung \eqref{ind} bereits erfüllt, dann gilt (zunächst analog wie bei $l=1$)

\begin{align*}
  \|k_{i_{l}}-\tilde{k_{i_{l}}}\| \leq& Lh \|\sum_{j=1}^{m}A_{i_{l}i_{j}}(k_{i_{j}}-\tilde{k_{i_{j}}})\| + L\|y-\tilde{y}\| \\
  \leq& Lh\sum_{j=1}^{l-1}|A_{i_{l}i_{j}}|\cdot\|k_{i_{j}}-\tilde{k_{i_{j}}}\| + Lh\sum_{j=l}^{m}|A_{i_{l}i_{j}}|\cdot\|k_{i_{j}}-\tilde{k_{i_{j}}}\| + L\|y-\tilde{y}\| \\
  \stackrel{}{\leq}& Lh\sum_{j=1}^{l-1}|A_{i_{l}i_{j}}|\cdot\|k_{i_{j}}-\tilde{k_{i_{j}}}\| + Lh\sum_{j=l}^{m}|A_{i_{l}i_{j}}| \cdot \|k_{i_{l}}-\tilde{k_{i_{l}}}\|+ L\|y-\tilde{y}\| \\
  \stackrel{IV}{\leq}& Lh\sum_{j=1}^{l-1}|A_{i_{l}i_{j}}|\cdot C_{j} \|y-\tilde{y}\| + Lh\sum_{j=l}^{m}|A_{i_{l}i_{j}}| \cdot \|k_{i_{l}}-\tilde{k_{i_{l}}}\|+ L\|y-\tilde{y}\| \\
  &\Rightarrow  \|k_{i_{l}}-\tilde{k_{i_{l}}}\| \underbrace{(1-Lh\sum_{j=l}^{m}|A_{i_{l}i_{j}}|)}_{\text{wieder~} >0} \leq L(1+h\sum_{j=1}^{l-1}C_{j}) \|y-\tilde{y}\| \\
  &\Rightarrow  \|k_{i_{l}}-\tilde{k_{i_{l}}}\| \leq \frac{L(1+h\sum_{j=1}^{l-1}C_{j})}{(1-Lh\sum_{j=l}^{m}|A_{i_{l}i_{j}}|)}\|y-\tilde{y}\| \leq \underbrace{\frac{L(1+h_{\max}\sum_{j=1}^{l-1}C_{j})}{(1-Lh_{\max}\sum_{j=l}^{m}|A_{i_{l}i_{j}}|)}}_{=:C_{l}} \|y-\tilde{y}\|
\end{align*}

Also folgt letztendlich, dass
\begin{align*}
  \|\phi(t,y,h) - \phi(t,\tilde{y},h)\| = \|\sum_{j=1}^{m}b_{i_{j}}(k_{i_{j}}-\tilde{k_{i_{j}}})\| \stackrel{ \eqref{ind}}{\leq} \underbrace{(\sum_{j=1}^{m}|b_{i_{j}}|C_{j})}_{=:C_{Stab}} \|y-\tilde{y}\|
\end{align*}
\end{solution}

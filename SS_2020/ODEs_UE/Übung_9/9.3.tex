\begin{exercise}
Betrachten Sie für $\lambda, \mu, \gamma, a > 0$ das System
\begin{align*}
  x^{\prime} &= - \lambda xy - \mu x + \mu a \\
  y^{\prime} &= \lambda xy - \mu y + \gamma y \\
  z^{\prime} &= \gamma y - \mu z.
\end{align*}
Zeigen Sie, dass das System im Fall $a\lambda > \mu - \gamma > 0$ genau eine
nichttriviale Ruhelage $(x^*,y^*,z^*) \in (0,\infty)^3$ hat. Zeigen Sie, dass
die Funktion
\begin{align*}
  V(x,y,z) = x - x^*\ln(x) + y - y^*\ln(y)
\end{align*}
eine Ljapunovfunktion ist. Was können Sie über die Stabilität der Ruhelage $(x^*,y^*,z^*)$
sagen?
\end{exercise}

\begin{solution}
Wir setzen $f$ gleich Null und erhalten drei Gleichungen
\begin{align}
  \mu (a-x) &= \lambda xy \label{1}\\
  y(\lambda x + \gamma - \mu) &= 0 \implies \lambda x  = \mu - \gamma \lor y = 0\\
  \mu z &= \gamma y \label{3}
\end{align}
Fall 1: $y = 0$: \\
Es folgt unmittelbar $z = 0, x = a$ \\
Fall 2: $y \neq 0$: \\
Es folgt $x = \frac{\mu - \gamma}{\lambda} > 0$. Setzen wir in die erste Gleichung ein
erhalten wir
\begin{align*}
  y = \frac{\mu a}{\mu - \gamma} - \frac{\mu}{\lambda}
  \iff y = \frac{\mu(\lambda a - (\mu - \gamma))}{(\mu - \gamma)\lambda} > 0
\end{align*}
Schließlich erhalten wir aus der letzten Gleichung
\begin{align*}
  z = \frac{\gamma}{\mu} \frac{\mu(\lambda a - (\mu - \gamma))}{(\mu - \gamma)\lambda} > 0.
\end{align*}
Damit lautet unsere eindeutige nichttriviale Ruhelage
\begin{align*}
  (x^*,y^*,z^*) = \left(\frac{\mu - \gamma}{\lambda},\frac{\mu(\lambda a - (\mu - \gamma))}{(\mu - \gamma)\lambda},
    \frac{\gamma}{\mu} \frac{\mu(\lambda a - (\mu - \gamma))}{(\mu - \gamma)\lambda}\right).
\end{align*}
Wieder ziehen wir das hinreichende Kriterium für eine strikte Ljapunovfunktion zu Rate
\begin{align*}
  \nabla V(x,y,z)f(x,y,z) &= \left(1 - \frac{x^*}{x}, 1 - \frac{y^*}{y}, 0\right)^{\top}
  \left(- \lambda xy - \mu x + \mu a,\lambda xy - \mu y + \gamma y, \gamma y - \mu z\right) \\
  &= \left(1 - \frac{x^*}{x})(- \lambda xy + \mu (a - x)\right) +
  \left(\left(1 - \frac{y^*}{y}\right)\left(\lambda xy - \mu y + \gamma y\right)\right) \\
  &= - \lambda xy + \mu (a - x) + \lambda x^*y - \mu \frac{x^*(a-x)}{x} + \lambda xy - \mu y + \gamma y
  + y^*(\mu - \gamma - \lambda x)  \\
  &= \mu \left(a - x - \frac{x^*(a-x)}{x}\right) + y(\gamma - \mu + \lambda x^*) + y^*(\mu - \gamma - \lambda x) \\
  &= \mu \left(a - x - \frac{(\mu - \gamma)(a-x)}{\lambda x}\right) + y(\gamma - \mu + \mu - \gamma) +
  y^*(\mu - \gamma - \lambda) \\
  &=\mu \frac{(a-x)(\gamma - \mu + \lambda x)}{\lambda x} + y^*(\mu - \gamma - \lambda x) \\
  &= \mu \frac{(a-x(1+\frac{\lambda}{\mu} y^*))(\gamma - \mu + \lambda x)}{\lambda x} \\
\end{align*}
Der Zähler hat also genau die Nullstellen $x^*, \frac{a}{1 + \frac{\lambda}{\mu}y^*}$.
Aufgrund \eqref{1} folgt
\begin{align*}
  \lambda x^*y + \mu x* = \mu a \iff x^* = \frac{\mu a}{1 + \lambda y*} = \frac{a}{1 + \frac{\lambda}{\mu}y^*}.
\end{align*}
Also hat der Zähler genau eine doppelte Nullstelle und
es kann daher im Zähler keinen Vorzeichenwechsel geben. Da der linke Faktor für $x \to \infty$ sicher negativ wird
und der rechte Faktor für $x \to \infty$ positiv, muss der Nenner insgesamt immer negativ sein.
Da die Ljapunovfunktion für für positive $x$ definiert ist, ist der Nenner immer positiv
und wir haben also eine strikte Ljapunovfunktion gegeben. \\
Setzen wir nun die Ruhelage in die Ljapunovfunktion ein:
\begin{align*}
  \nabla V(x^*,y^*,z^*) = \left(1 - \frac{x^*}{x^*}, 1 - \frac{y^*}{y^*}, 0\right) = (0,0,0).
\end{align*}
Betrachten wir nun die Hesse-Matrix
\begin{align*}
  D^2 V(x^*,y^*,z^*) = \begin{pmatrix}
    1 + \frac{x^*}{(x^*)^2} & 0 & 0 \\
    0 & 1 + \frac{y^*}{(y^*)^2} & 0 \\
    0 & 0 & 0
  \end{pmatrix}
  = \begin{pmatrix}
    1 + \frac{1}{x^*} & 0 & 0\\
    0 & 1 + \frac{1}{y^*} & 0 \\
    0 & 0 & 0 \\
  \end{pmatrix},
\end{align*}
welche positiv semidefinit ist. Wie man leicht erkennt, kann $(x^*,y^*,z^*)$ kein
striktes Minimum von $V$ sein, da $V$ gar nicht von $z$ abhängt. Damit können wir
die direkte Methode von Ljapunov nicht anwenden und somit nichts über die Stabilität
der Ruhelage aussagen.
Nachdem unser Versuch mit der Ljapunovfunktion gescheitert ist, können wir noch
versuchen, das Prinzip der linearisierten Stabilität zu bemühen. Also berechnen wir
\begin{align*}
  Df(x,y,z) = \begin{pmatrix}
  -\lambda y - \mu & - \lambda x & 0 \\
  \lambda y& \lambda x + \gamma - \mu & 0 \\
  0 & \gamma & -\mu
  \end{pmatrix}.
\end{align*}
Setzen wir unsere Ruhelage ein, erhalten wir
\begin{align*}
  Df(x^*,y^*,z^*) = \begin{pmatrix}
  -\frac{\mu(\lambda a - (\mu - \gamma))}{\mu - \gamma} - \mu & \gamma - \mu & 0 \\
  \frac{\mu(\lambda a - (\mu - \gamma))}{\mu - \gamma}& 0 & 0 \\
  0 & \gamma & -\mu
  \end{pmatrix}
\end{align*}
Das charakteristische Polynom davon lautet
\begin{align*}
  \chi(\zeta) = \left(-\frac{\mu(\lambda a - (\mu - \gamma))}{\mu - \gamma} - \mu - \zeta\right)(\zeta)
  (\mu + \zeta) + (\gamma - \mu)
  \left(\frac{\mu(\lambda a - (\mu - \gamma))}{\mu - \gamma}\right)
  (\mu + \zeta) \stackrel{!}{=} 0
\end{align*}
und erhalten als erste Nullstelle $\zeta_1 = -\mu < 0$.
\begin{align*}
  0 &\stackrel{!}{=} \left(-\frac{\mu(\lambda a - (\mu - \gamma))}{\mu - \gamma} - \mu - \zeta\right)\zeta
  + (\gamma - \mu)\left(\frac{\mu(\lambda a - (\mu - \gamma))}{\mu - \gamma}\right) \\
  &= \left(-\frac{\mu\lambda a}{\mu - \gamma} - \zeta\right)\zeta
  + (\gamma - \mu)\left(\frac{\mu(\lambda a - (\mu - \gamma))}{\mu - \gamma}\right)\\
  &= -\zeta^2 - \zeta\left(\frac{\mu\lambda a}{\mu - \gamma}\right)
  + \mu(\mu - \gamma - \lambda a).
\end{align*}
Wir erinnern nochmals an die Voraussetzungen
\begin{align*}
  \lambda, \mu, \gamma, a &> 0 \\
  \mu - \gamma &> 0 \\
  \mu - \gamma - a\lambda &< 0.
\end{align*}
Die letzten beiden Nullstellen lauten somit
\begin{align*}
  \zeta_{2,3} = - \left(\frac{\mu\lambda a}{2(\mu - \gamma)}\right)
  \pm \sqrt{\left(\frac{(\mu\lambda a)^2}{4(\mu - \gamma)^2}\right)
   + \underbrace{\mu(\mu - \gamma - \lambda a)}_{< 0}}
\end{align*}
Fall 1: $\left(\frac{(\mu\lambda a)^2}{4(\mu - \gamma)^2}\right)
 + \mu(\mu - \gamma - \lambda a) < 0$
 \begin{align*}
   \Re(\zeta_{2,3}) = - \left(\frac{\mu\lambda a}{2(\mu - \gamma)}\right) < 0
 \end{align*}
 Fall 2: $\left(\frac{(\mu\lambda a)^2}{4(\mu - \gamma)^2}\right)
  + \mu(\mu - \gamma - \lambda a) \geq 0$
  \begin{align*}
    \zeta_{2,3} < - \left(\frac{\mu\lambda a}{2(\mu - \gamma)}\right)
    \pm \sqrt{\left(\frac{(\mu\lambda a)^2}{4(\mu - \gamma)^2}\right)} \leq 0
  \end{align*}
  In jedem Fall sind die Realteile aller Eigenwerte negativ und mit dem Prinzip
  der linearisierten Stabilität ist unsere Ruhelage asymptotisch stabil.
\end{solution}

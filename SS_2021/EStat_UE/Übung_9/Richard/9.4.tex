% -------------------------------------------------------------------------------- %

\begin{exercise}[Most powerful test for the normal variance - $\mu$ is known]

Let $X_1, \dots, X_n$ be iid $\mathcal N(\mu, \sigma^2)$, where $\mu$ is known.

\begin{enumerate}[label = (\alph*)]

    \item Find an MP test at level $\alpha$ for testing two simple hypoheses
    
    \begin{align*}
        H_0: \sigma^2 = \sigma_0^2
        \quad
        \textit{vs}
        \quad
        H_1: \sigma^2 = \sigma_1^2, \sigma_1 > \sigma_0.
    \end{align*}

    \item Show that the MP teset is a UMP teset for testing
    
    \begin{align*}
        H_0: \sigma^2 \leq \sigma_0^2
        \quad
        \textit{vs}
        \quad
        H_1: \sigma^2 > \sigma_0^2.
    \end{align*}

    \textit{Hint:}
    $\sum_i (X_i - \mu)^2 \sim \sigma^2 \chi^2(n)$.

\end{enumerate}

\end{exercise}

% -------------------------------------------------------------------------------- %

\begin{solution}

First, we show the hint.

\begin{align*}
    \pbraces{\frac{X_i - \mu}{\sigma}}^2 \sim \chi^2(1)
    & \implies
    (X_i - \mu)^2 \sim \sigma^2 \chi^2(1) \\
    & \implies
    T(\mathbf X) := \sum_{i=1}^n (X_i - \mu)^2 \sim \sigma^2 \chi^2(n)
\end{align*}

\begin{enumerate}[label = (\alph*)]

    \item We proceed analogously to the previous exercise.
    
    \begin{align*}
        \lambda(\mathbf x)
        & =
        \frac
        {
            L(\sigma_1 \mid \mathbf x)
        }{
            L(\sigma_0 \mid \mathbf x)
        } \\
        & =
        \frac
        {
            \prod_{i=1}^n
                \frac{1}{\sqrt{2 \pi \sigma_1^2}}
                e^{-\frac{(x_i - \mu)^2}{2 \sigma_1^2}}
        }{
            \prod_{i=1}^n
                \frac{1}{\sqrt{2 \pi \sigma_0^2}}
                e^{-\frac{(x_i - \mu)^2}{2 \sigma_0^2}}
        } \\
        & =
        \pbraces{\frac{\sigma_0}{\sigma_1}}^2
        \exp \sum_{i=1}^n \frac{(x_i - \mu)^2}{2 \sigma_0} - \frac{(x_i - \mu)^2}{2 \sigma_1} \\
        & =
        \pbraces{\frac{\sigma_0}{\sigma_1}}^2
        \exp \pbraces{\frac{1}{2} \frac{\sigma_1 - \sigma_0}{\sigma_0 \sigma_1} T(\mathbf x)}
    \end{align*}

    \begin{align*}
        \Omega_1
        :=
        \Bbraces{\mathbf x: \lambda(\mathbf x) \geq C}
    \end{align*}

    \begin{align*}
        \lambda(\mathbf x) \geq C
        \iff
        T(\mathbf x) \geq 2 \frac{\sigma_0 \sigma_1}{\sigma_1 - \sigma_0} \ln \pbraces{\pbraces{\frac{\sigma_1}{\sigma_0}}^2 C} =: C^\star
    \end{align*}

    \begin{align*}
        \implies &
        \alpha = P_{\sigma_0}(\lambda(\mathbf X) \geq C) = P_{\sigma_0}(T(\mathbf X) \geq C^\star) = 1 - P_{\sigma_0}(T(\mathbf X) \leq C^\star) \\
        \implies &
        1 - \alpha = P_{\sigma_0}(T(\mathbf X) / \sigma_0^2 \leq C^\star / \sigma_0^2) = F_{\chi^2(n)}(C^\star / \sigma_0^2) \\
        \implies &
        C^\star / \sigma_0^2 = \chi_{1 - \alpha}^2(n) \\
        \implies &
        C^\star = \sigma_0^2 \chi_{1 - \alpha}^2(n)
    \end{align*}

    \item We proceed analogously to the previous exercise.

\end{enumerate}

\end{solution}

% -------------------------------------------------------------------------------- %

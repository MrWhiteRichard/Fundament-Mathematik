% --------------------------------------------------------------------------------

\begin{exercise}[Uniform distribution]

Let $X_1, \dots, X_n$ be a random sample from uniform $(\theta, 1)$ distribution, where $\theta < 1$ is an unknown parameter.

\begin{enumerate}[label = (\alph*)]

    \item Find the MLE $\hat \theta$ of $\theta$.

    \item Is $\hat \theta$ asymptotically normal?
    If yes, find the asymptotic mean and variance.
    Otherwise, find a sequence $r_n$ and $a_n$ suh that $r_n (\hat \theta - a_n)$ converges in distribution to a non-degenerate (not pointmass) distribution.

\end{enumerate}

\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}

\phantom{}

\begin{enumerate}[label = (\alph*)]

    \item

    \begin{align*}
        L_n(\theta \mid x)
        & =
        f_{X_1, \dots, X_n}(x \mid \theta) \\
        & =
        \prod_{i=1}^n
            f_{X_i}(x_i \mid \theta) \\
        & =
        \prod_{i=1}^n
            \frac{1}{1 - \theta} \mathbf 1_{(\theta, 1)}(x_i) \\
        & =
        \frac{1}{(1 - \theta)^n} \mathbf 1_{(\theta, 1)^n}(x) \\
        & =
        \frac{1}{(1 - \theta)^n}
        \mathbf 1_{(\theta, \infty)}
        \pbraces
        {
            \min_{i=1}^n x_i
        }
        \mathbf 1_{(-\infty, 1)}
        \pbraces
        {
            \max_{i=1}^n x_i
        }
    \end{align*}

    We go back to the definition of the maximum liklihood estimator, on \cite*[lecture 6, slide 47]{EStat}.
    The liklihood gien $x$ is zero for $\theta > \min_{i=1}^n x_i$ and is an increasing function of $\theta$ for $\theta \leq \min_{i=1}^n x_i$.
    As a consequence, the maximum liklihood estimator of $\theta$ is

    \begin{align*}
        \hat \theta
        & =
        \min_{i=1}^n X_i \\
        & =
        X_{(1)},
    \end{align*}

    the smallest order statistic.

    \item The cdf of $\hat \theta$ is

    \begin{align*}
        F_{\hat \theta}(x)
        & =
        \P \pbraces{\min_{i=1}^n X_i \leq x} \\
        & =
        1 - \P \pbraces{\min_{i=1}^n X_i > x} \\
        & =
        1 - \prod_{i=1}^n \P(X_i > x) \\
        & =
        1 - \P(X_1 > x)^n \\
        & =
        1 - (1 - \P(X_1 \leq x))^2 \\
        & =
        1 - (1 - F_{X_1}(x))^n \\
        & =
        \begin{cases}
            0,
            & x \leq \theta, \\
            1 - \pbraces{1 - \frac{x - \theta}{1 - \theta}}^n,
            & \theta < x < 1, \\
            1,
            & 1 \leq x.
        \end{cases}
    \end{align*}

    The asymptotic cdf is $\mathbf 1_{(0, \infty)}(x)$;
    the asymptotic pdf is the $\theta$-shifted delta distribution $\delta_\theta$, because

    \begin{align*}
        \Forall \varphi \in C_0^\infty:
            \abraces{\mathbf 1_{(\theta, \infty)}^\prime, \varphi}
            & =
            - \abraces{\mathbf 1_{(\theta, \infty)}, \varphi^\prime} \\
            & =
            -\int_{-\infty}^\infty
                \mathbf 1_{(\theta, \infty)}(x) \varphi^\prime(x)
                ~ \mathrm d x \\
            & =
            -\int_\theta^\infty
                \varphi^\prime(x)
                ~ \mathrm d x \\
            & =
            -\varphi(x) \Big |_{x=\theta}^\infty \\
            & =
            \varphi(\theta) \\
            & =
            \abraces{\delta_\theta, \varphi}.
    \end{align*}

    Let us calculate the cdf of the affine transformed $\hat \theta$.

    \begin{align*}
        F_{r_n (\hat \theta - a_n)}(x)
        & =
        \P \pbraces{r_n \pbraces{\min_{i=1}^n X_i - a_n} \leq x} \\
        & =
        \P \pbraces{\min_{i=1}^n X_i \leq \frac{x}{r_n} + a_n} \\
        & ~~ \vdots \\
        & =
        \begin{cases}
            0,
            & x / r_n + a_n \leq \theta
            \iff
            x \leq r_n (\theta - a_n), \\
            1 - \pbraces{1 - \frac{x / r_n + a_n - \theta}{1 - \theta}}^n,
            & \theta < x / r_n + a_n < 1
            \iff
            r_n (\theta - a_n) \leq x \leq r_n (1 - a_n), \\
            1,
            & 1 \leq x / r_n + a_n
            \iff
            r_n (1 - a_n) \leq x
        \end{cases}
    \end{align*}

    Now, we can see that this expression screams \enquote{Euler}.
    Thus, we set

    \begin{align*}
        a_n := \theta,
        \quad
        \text{and}
        \quad
        r_n := \frac{n}{\theta - 1},
        \quad
        \text{for}
        \quad
        n \in \N.
    \end{align*}

    Plugging in, we get

    \begin{align*}
        \cdots
        & =
        \begin{cases}
            0,
            & x \leq 0, \\
            1 - \pbraces{1 + \frac{x}{n}}^n,
            & 0 < x < n, \\
            1,
            & n \leq x
        \end{cases} \\
        & \xrightarrow{n \to \infty}
        (1 - \mathrm e^x) \mathbf 1_{0, \infty}(x).
    \end{align*}

    Finally,

    \begin{align*}
        r_n (\hat \theta - a_n)
        \xrightarrow[n \to \infty]{\text d}
        \exp(1).
    \end{align*}

\end{enumerate}

\end{solution}

% --------------------------------------------------------------------------------

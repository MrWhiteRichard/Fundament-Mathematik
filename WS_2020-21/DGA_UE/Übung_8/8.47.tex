% --------------------------------------------------------------------------------

\begin{exercise}

\phantom{}Nehmen Sie an, Sie wollen die Ausgaben 0 und 1 mit Wahrscheinlichkeit je $\frac{1}{2}$ erhalten. Dazu steht Ihnen die Prozedur Biased-Random zur Verfügung, die den Wert 1 mit Wahrscheinlichkeit $p$ und den Wert 0 mit Wahrscheinlichkeit $1-p$ ausgibt $(0 < p < 1)$. Sie wissen aber nicht, wie groß $p$ ist. Geben Sie einen Algorithmus (in Pseudocode) an, der Biased-Random als Unterroutine verwendet und den Wert 0 mit Wahrscheinlichkeit $\frac{1}{2}$ und den Wert 1 ebenfalls mit Wahrscheinlichkeit $\frac{1}{2}$ zurückgibt. Wie groß ist die erwartete Laufzeit ihres Algorithmus als Funktion von $p$?

\end{exercise}

% --------------------------------------------------------------------------------


\begin{solution}

  \begin{algorithm}
      \begin{algorithmic}[1]
          \Procedure{Random}
          \State $x = y = 0;$
          \While{$x \neq y$}
              \State $x$ = \textsc{Biased-Random()}
              \State $y$ = \textsc{Biased-Random()}
          \EndWhile
          \Return $x$
          \EndProcedure
      \end{algorithmic}
  \end{algorithm}
%\phantom{}\begin{algorithm}[H]
%\SetAlgoLined
%x, y = 0\;
%\While{$x = y$}{
%              $x$ = \textsc{Biased-Random()}\;
%            $y$ = \textsc{Biased-Random()}\;
%}
%\Return $x$;
%    \caption{Random aus Biased-Random erzeugen}
%\end{algorithm}

Der Algorithmus ist \glqq korrekt\grqq{}, da das Auftreten von $(x, y) = (1, 0)$ und $(x, y) = (0, 1)$ gleich wahrscheinlich ist.

Es gilt $\mathbb P(x \neq y) = 2p(1-p) =\colon q$. Die Wahrscheinlichkeit, genau beim $n$-ten Durchlauf $x \neq y$ zu erhalten, ist $q (1-q)^{n-1}$. Daher gilt
\begin{align*}
    \mathbb E(\text{notwendige Durchläufe}) = q \sum_{i = 1}^\infty n (1-q)^{n-1} \stackrel{(\ast)}{=} \frac{q}{(1-(1-q))^2} = \frac{q}{q^2} = \frac{1}{q}.
\end{align*}

Dabei haben wir verwendet, dass
\begin{align}\tag{$\ast$}
    \sum_{i = 1}^\infty nx^{n-1} = \sum_{i = 1}^\infty \frac{\mathrm d}{\mathrm dx} x^n =
    \frac{\mathrm d}{\mathrm dx} \sum_{i = 1}^\infty x^n =
    \frac{\mathrm d}{\mathrm dx} \frac{1}{1-x} = \frac{1}{(1-x)^2}.
\end{align}

\end{solution}

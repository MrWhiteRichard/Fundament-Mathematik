% --------------------------------------------------------------------------------

\begin{exercise}

Das (diskrete) Rucksack-Problem.
Sie haben schon wieder gewonnen!
Diesmal dürfen Sie sich unter $n$ Gegenständen (die Sie aber nicht zerteilen dürfen), wobei der $i$-te Gegenstand $v_i$ Euro wert ist und $w_i$ Kilo wiegt, so viele aussuchen und in Ihrem Rucksack hineinpacken, so viel Sie tragen können.
Wir nehmen dabei weiters immer an, dass $v_i$, $w_i$ und $W$ positive ganze Zahlen sind.
Die Aufgabe beim \Quote{Rucksack-Problem} besteht nun darin, anzugeben, welche Gegenstände Sie mitnehmen sollen, sodass der Gesamtwert der eingepackten Gegenstände möglichst groß ist.

Etwas genauer:
Gesucht ist $f(n, W)$, wenn

\begin{align*}
  f(m, W^\prime)
  =
  \max
  \Bbraces
  {
    \sum_{i=1}^m
      x_i v_i
    ~\Bigg |~
    \sum_{i=1}^m
      x_i w_i
    \leq
    W^\prime
    ~\text{und}~
    x_i \in \Bbraces{0, 1}
  },
\end{align*}

für $m \in \Bbraces{1, 2, \dots, n}$ und $W^\prime \in \Bbraces{0, \dots, W}$.

\begin{enumerate}[label = \alph*]

  \item Überlegen Sie sich, dass das Rucksack-Problem die optimale Teilstruktur-Eigenschaft (wie lautet diese hier?) besitzt.

  \item Geben Sie eine Rekursion für $f(m, W^\prime)$, also für den Wert von optimalen Teillösungen des ursprünglichen Problems an.

  \textit{Anmerkung:}
  Diese Rekursion hängt nun anders als beim vorigen Beispiel von beiden Parametern $m$ und $W^\prime$ ab.

  \item Man gebe einen Algorithmus an, der unter Zuhilfenahme von dynamischer Programmierung das Rucksack-Problem löst.

\end{enumerate}

\end{exercise}

% --------------------------------------------------------------------------------


\begin{solution}

\phantom{}

\begin{enumerate}[label = \alph*]

  \item \textbf{Behauptung.}
  Seien $\sum_{i=1}^n x_i v_i = f(n, W)$, d.h. eine optimale Lösung zum Gewicht $W$ und $m \in \Bbraces{1, \dots, n}$.
  Dann ist $\sum_{i=1}^m x_i v_i = f(m, W^\prime)$, d.h. eine optimale Lösung zum Gewicht $W^\prime := W - \sum_{i=m+1}^n x_i w_i$ und den Gegenständen $1, \dots, m$.
  $\sum_{i=m+1}^n x_i v_i$ ist dann auch eine optimale Lösung zum Gewicht $\sum_{i=m+1}^n x_i w_i$ und den Gegenständen $m + 1, \dots, n$.
  
  \textit{Beweis.}
  Seien unsere $x_1, \dots, x_n$, sodass $\sum_{i=1}^n x_i v_i$ maximal ist, unter der Bedingung $\sum_{i=1}^n x_i w_i \leq W$.
  Angenommen

  \begin{align*}
    \Exists \tilde x_1, \dots, \tilde x_m:
    \sum_{i=1}^m
      \tilde x_i v_i
    >
    \sum_{i=1}^m
      x_i v_i,
    \quad
    \sum_{i=1}^m
      \tilde x_i w_i
    \leq
    W^\prime.
  \end{align*}

  Dann wäre aber

  \begin{align*}
    \sum_{i=1}^m
      \tilde x_i v_i
    +
    \sum_{i=m+1}^n
      x_i v_i
    >
    \sum_{i=1}^n
      x_i v_i,
    \quad
    \sum_{i=1}^m
      \tilde x_i w_i
    +
    \sum_{i=m+1}^n
      x_i w_i
    \leq
    W.
  \end{align*}

  Widerspruch!

  \item Wir verwenden die oben gezeigt Teilstruktur-Eigenschaft für $m = n-1$.

  \begin{align*}
    f(\cdot, 0) = f(0, \cdot) = 0,
    \quad
    f(n, W)
    =
    \begin{cases}
      f(n - 1, W),                                       & w_n > W,   \\
      \max \Bbraces{f(n-1, W), v_n + f(n - 1, W - w_n)}, & w_n \leq W
    \end{cases}
  \end{align*}

  \item

  \begin{algorithmic}
    \Procedure{$f$}{$n, W$}
      \State Sei $f[0, \dots, n][1, \dots, W] = 0$ ein neues Datenfeld.
      \For{$i = 1, \dots, n$}
        \For{$j = 1, \dots, W$}
          \If{$w_i \leq j$}
            \State $f[i, j] = \max \Bbraces{v_i + f[i-1, j-w_i], f[i-1, j]}$
          \Else
            \State $f[i, j] = f[i-1, j]$
          \EndIf
        \EndFor
      \EndFor
      \State \Return $f[n, W]$
    \EndProcedure
  \end{algorithmic}

\end{enumerate}

\end{solution}

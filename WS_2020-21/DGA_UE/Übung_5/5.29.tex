% --------------------------------------------------------------------------------

\begin{exercise}

Gegeben ist die Divide-and-Conquer-Rekursion

\begin{align*}
  T(n) = aT\left(\frac{n}{b}\right) + f(n)
\end{align*}

wobei $f(n)$ eine nichtnegative Funktion mit asymptotischen Wachstum $\Theta(n^{\log_b(a)}\log (n))$ ist. Zeigen Sie für den Fall $n = b^k, k \in \N$, dass $T(n) = \Theta(n^{\log_b(a)}\log^2 (n))$

\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}
Wir gehen wie im Beweis des Master-Theorems vor:
\begin{align*}
  T(n) &= \Theta\left(n^{\log_b(a)}\right) +
  \underbrace{\sum_{w \in X_I(n)}a^{|w|}f\left(\frac{n}{b^{|w|}}\right)}_{=: g(n)} \\
  g(n) &= \Theta\left(\sum_{w \in X_I(n)}a^{|w|}
  \left(\frac{n}{b^{|w|}}\right)^{\log_b(a)}\log \left(\frac{n}{b^{|w|}}\right)\right) \\
  &\stackrel{?}{=} \Theta\left(\sum_{j = 0}^{\lfloor \log_b(n) \rfloor -1}a^{j}
  \left(\frac{n}{b^{j}}\right)^{\log_b(a)}\log \left(\frac{n}{b^{j}}\right)\right) \\
  &= \Theta\left(n^{\log_b(a)}\sum_{j = 0}^{\lfloor \log_b(n) \rfloor -1}
  \left(\frac{a}{b^{\log_b(a)}}\right)^j \log \left(\frac{n}{b^{j}}\right)\right) \\
  &= \Theta\left(n^{\log_b(a)}\sum_{j = 0}^{\lfloor \log_b(n) \rfloor -1}
  \log(n) - j\log(b)\right) \\
  &= \Theta\left(n^{\log_b(a)}\lfloor \log_b(n) \rfloor\left(\log(n) -
  \log(b)\frac{\lfloor \log_b(n) \rfloor -1}{2}\right)\right) \\
  &= \Theta\left(n^{\log_b(a)}\lfloor \log_b(n) \rfloor^2\right)
  =  \Theta\left(n^{\log_b(a)}\log^2(n)\right)
\end{align*}
Das ? machen wir im Skript genauso, ich weiß aber nicht genau warum wir das dürfen.
\end{solution}

% --------------------------------------------------------------------------------

\begin{solution}
	Wir schauen uns noch einen alternativen Beweis an. Dafür definieren wir für alle $k \in \N$ die Funktion $S(k) := T(b^k)$ und erhalten für $k \in \N^+$
	\begin{align*}
	S(k) = T(b^k) = aT(b^{k-1}) + f(b^k) = a S(k-1) + f(b^k)
	\end{align*}
	Nun wollen wir $S(k) = \Theta(a^k k^2 (\log(b))^2)$ beweisen, wobei $f(b^k) = \Theta(a^k k\log(b))$. Wir wählen zuerst ein $c_0 > 0$ und ein $k_0 \in \N$, sodass für alle $k \geq k_0$ gilt, dass $f(b^k) \leq c_0 a^k k \log(b)$. Weiters wünschen wir uns für alle $k \geq k_0$
	\begin{align*}
	c_1 a^k k^2 (\log(b))^2 \stackrel{!}{\geq} S(k) = a S(k-1) + f(b^k) \leq  c_1 a^k (k - 1)^2 (\log(b))^2 + c_0 a^k k \log(b) \\
	\Leftarrow c_1 a^k (\log(b))^2( k^2 - (k -1)^2) \geq c_0 a^k k \log(b) \\
	\Leftarrow c_1 \geq \frac{c_0 k}{(2k -1) \log(b)}
	\end{align*}
	und zuletzt wollen wir noch, um beim Induktionsanfang keine Probleme zu bekommen, $S(k_0) \geq c_1 a^{k_0} k_0^2 (\log(b))^2$. \\
	Für die andere Abschätzung wollen wir $c_2 > 0$ und $k_1 \in \N$, sodass für alle $k \geq k_0$ die Ungleichung $f(b^k) \geq c_2 a^k k \log(b)$ gilt. Diesmal handeln wir den Induktionsanfang gleich ab und wünschen uns $c_3 > 0$ mit $S(k_0) \geq c_3 a^{k_0} k_0^2 (\log(b))^2 $. Darüber hinaus wollen wir noch für alle $k > k_0$
	\begin{align*}
	c_3 a^k k^2 (\log(b))^2 \stackrel{!}{\leq} S(k) = a S(k-1) + f(b^k) \geq c_3 a^k (k - 1)^2 (\log(b))^2 + c_2 a^k k \log(b) \\
	\Leftarrow c_3 \leq \frac{c_2 k}{(2k - 1) \log(b)}
	\end{align*}
\end{solution}

% -------------------------------------------------------------------------------- %

\begin{exercise}

Bestimmen Sie eine Rekursion für die mittlere Anzahl der Schlüsselvergleiche beim
(nichtrandomisierten) Quicksort, wenn anstelle des letzten Elements $A[n]$ da
der Größe nach mittlere der drei Elemente $A[1],A[\floorbraces{\frac{n}{2}}]$
und $A[n]$ als Pivot-Element verwendet wird. Das Lösen dieser Rekursion ist nicht
verlangt.

\end{exercise}

% -------------------------------------------------------------------------------- %


\begin{solution}

Wir berechnen zuerst die Wahrscheinlichkeit, dass das mittlere von drei zufällig
gewählten Elementen aus $[1,\dots,n]$ gleich $j$ ist. \\
Die Anzahl aller Kombinationen von $3$ aus $n$ Elementen ohne Wiederholung ist genau $\binom{n}{3}$.
Die Wahrscheinlichkeit dass das mittlere Element der Kombination gleich $j$ ist,
lässt sich umformulieren als die Wahrscheinlichkeit, dass $j$ in der Kombination liegt
und zusätzlich genau ein Element aus $[1,\dots,j-1]$ ebenfalls in der Kombination liegt.
Seien $(k_1,k_2,k_3)$ die aufsteigend sortierten Elemente der Kombination $k$.
Für $2 \leq j \leq n - 1$ gilt dann
\begin{align*}
  \P(k_2 = j) = \P(j \in k \text{ und } |[1,\dots,j-1]\cap k| = 1)
  = \frac{3}{n}\left[\left(1- \frac{2}{n-1}\right)^{j-2}\frac{2}{n-1}(j-1)\right]
  =(j-1)\left(\frac{2}{n-1}\right)^{2}\left(1- \frac{2}{n-1}\right)^{j-2}
\end{align*}
Damit erhalten wir unsere Rekursion
\begin{align*}
  T(n) = \sum_{j=2}^{n-1}(j-1)\left(\frac{2}{n-1}\right)^{2}\left(1- \frac{2}{n-1}\right)^{j-2}
  [T(n-j) + T(j - 1)] + n
\end{align*}
\end{solution}

% -------------------------------------------------------------------------------- %

\begin{solution}
	Das Ergebins hier schaut anders aus, ist es womöglich äquivalent? Sei $X_n: S_n \to \{1, \dots, n\}$ eine Zufallsvariable, welche jede Permutation $A$ der Elemente $1, \dots, n$ abbildet auf das mittlere der drei $A[1], A\bbraces{\floorbraces{\frac{n}{2}}}$ und $A[n]$. Für jedes $1 < j < n$ gilt
	\begin{align*}
		\mathbb{P}\pbraces{X_n = j} &= 6 \mathbb{P}\pbraces{A[1] < A\bbraces{\floorbraces{\frac{n}{2}}} \land A\bbraces{\floorbraces{\frac{n}{2}}} < A[n] \land A\bbraces{\floorbraces{\frac{n}{2}}} = j} \\
		&= 6 \mathbb{P}\pbraces{A\bbraces{\floorbraces{\frac{n}{2}}} = j} \mathbb{P}\pbraces{A[1] < j} \mathbb{P}\pbraces{j < A[n]} = \frac{6}{n}\frac{j - 1}{n - 1}\frac{n - j}{n - 2}.
	\end{align*}
	Wir erhalten für die Laufzeit also die Rekursion
	\begin{align*}
		T(n) = \Landau(n) + \sum_{j=2}^{n-1} \frac{6}{n}\frac{j - 1}{n - 1}\frac{n - j}{n - 2}
		[T(n-j) + T(j - 1)].
	\end{align*}

  Bezeichne $S(n)$ die durchschnittliche Anzahl der Schlüsselvergleiche, dann erhalten wir die Rekursion
  \begin{align*}
    S(n) = \sum_{j=2}^{n-1} \frac{6}{n}\frac{j - 1}{n - 1}\frac{n - j}{n - 2}[S(n-j)+S(j-1)] + 3
  \end{align*}
  mit $S(0) = S(1) = 0$ und $S(2) = 1$.
\end{solution}

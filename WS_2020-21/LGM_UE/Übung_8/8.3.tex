% --------------------------------------------------------------------------------

\begin{exercise}[194 + 195]

Zeigen Sie, dass mehrere der folgenden Funktionen primitiv rekursiv sind:
(Manche dieser Funktionen sind gelegentlich undefiniert, z.B. an der Stelle $0$.
Setzen Sie die Funktion so zu einer totalen Funktion fort, dass Sie von der
Fortsetzung zeigen können, dass sie primitiv rekursiv ist.) \\

\textbf{Geben Sie explizit die primitiv rekursiven Funktionen $h$ und $g$ an,
die Sie im Schema der primitiven Rekursion
\footnote{Gemeint ist eine Definition der Form $f(\vv{x},0) = h(\vv{x}),\
f(\vv{x}, y + 1) = g(\vv{x}, f(\vv{x},y), y)$. Aus notationellen Gründen
treten oft die als trivial geltenden Projektionen $\Pi_k^n$ auf.}
verwenden.}

\begin{enumerate}
	\item Addition, Multiplikation, $n!$, modulo-Funktion, $\binom{n}{k}$
	\item Die durch
	\begin{align*}
		f(x) = \begin{cases}
			g(x) & \text{wenn } x \in A \\
			h(x) & \text{sonst}
		\end{cases}
	\end{align*}
	definierte Funktion, wenn $g,h$ primitiv rekursive Funktionen sind und $A$
	eine primitiv rekursive Menge.
	\item Die charakteristische Funktion jeder endlichen Menge.
	\item $(n,k) \mapsto (q,r)$ mit $qk + r = n,\ 0 \leq r < k$.
	\item $(n,k) \mapsto \lfloor \frac{n}{k} \rfloor$. (Gaußklammer)
	\item $(n,k) \mapsto \max(0, \lfloor \frac{p(n)}{q(k)}\rfloor)$,
	wobei $p$ und $q$ beliebige Polynome mit ganzzahligen (möglicherweise
	negativen) Koeffizienten sind.
	\item Die Funktion $(n,k) \mapsto k$-te Dezimalstelle von $n$.
	\item $n \mapsto \lfloor \sqrt{2}*10^n\rfloor$.
	\item Eine geeignete (von Ihnen zu wählende) injektive (bijektive?) Abbildung
	$\N \times \N \to \N$.
	\item Die Fibonacci-Folge $f(0) = f(1) = 1,\ f(n+2) = f(n+1) + f(n)$.\\
	\textit{Hinweis:} Betrachten Sie zunächst die Funktion $n \mapsto 2^{f(n)}\cdot 3^{f(n+1)}$.
	\item Ihre Lieblingsfunktion. (Möglichst nichttrivial.)

\end{enumerate}

\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}
	\phantom{}
	\begin{enumerate}
		\item Addition $ + = \mathrm{PR}(\pi_1^1, s\circ\pi_3^3)$:
			\begin{align*}
			\forall x \in \N : +(x,0) &= x + 0 = x = \pi_1^1(x) \\
			\forall x, y \in \N : +(x,y+1) &= x + (y + 1) = (x + y) + 1 = s\circ \pi_3^3(x,y,+(x,y))
			\end{align*}
			Multiplikation $\cdot =\mathrm{PR}(0,+(\pi_1^3,\pi_3^3))$:
			\begin{align*}
			\forall x \in \N : \cdot(x,0) &= x \cdot 0 = 0 \\
			\forall x,y \in \N: \cdot(x,y+1) &= x(y+ 1) = xy + x = +(\pi_1^3,\pi_3^3)(x,y,\cdot(x,y))
			\end{align*}
			Vorgänger $v = \mathrm{PR}(0,s\circ\pi_1^2)$:
			\begin{align*}
			 \forall x \in \N^0: v(,0) &= 0 \\
			 \quad \forall x \in \N^0\, \forall y \in \N:v(,y+1) &= y + 1 - 1 = y = s\circ \pi_1^2(,y,v(,y))
			\end{align*}
			Subtraktion $- = \mathrm{PR}(\pi_1^1,v\circ\pi_3^3)$:
			\begin{align*}
			\forall x \in \N: -(x,0) &= x - 0 = x = \pi_1^1(x)\\
			\forall x \in \N\, \forall y \in \N: -(x,y+1) &= x - (y + 1) = (x - y) - 1 = v\circ\pi_3^3(x,y,-(x,y))
			\end{align*}
			Faktorielle $! = \mathrm{PR}(s\circ0,\cdot(s\circ\pi_1^2,\pi_2^2))$:
			\begin{align*}
				\forall x \in \N^0: 0! &= 1 = s\circ 0(,)\\
				\forall x \in \N^0\, \forall y \in \N: (y + 1)! &= y! (y + 1) = \cdot(s\circ\pi_1^2,\pi_2^2)(,y,y!)
			\end{align*}
		\item
			\begin{align*}
			f(x) = \begin{cases}
			g(x) & \text{wenn } x \in A \\
			h(x) & \text{sonst}
			\end{cases},
			\end{align*}
			wobei $f,g, \chi_A$ primitiv rekursive Funktionen sind.
			\begin{align*}
			f(x) &= \chi_A(x) g(x) + (1 - \chi_A(x)) h(x) \\
			&= +(\cdot(\chi_A,g), \cdot(-(1,\chi_A),h))(x)
			\end{align*}
		\item $\chi_{\{0\}}$
			\begin{align*}
			\chi_{\{0\}}(0) &= 1 = s\circ 0 \\
			\forall y \in \N: \chi_{\{0\}}(y + 1) &= 0
			\end{align*}
		$\chi_{\{a\}}$ für $a \in \N$
			\begin{align*}
			\chi_{\{a\}}(x) = \chi_{\{0\}}(a - x) \chi_{\{0\}}(x - a)
			\end{align*}
		$\chi_A$ für eine endliche Menge $A = \{a_1, \dots, a_l\} \subseteq \N$
			\begin{align*}
			\chi_A = \chi_{\{a_1\}} + \dots + \chi_{\{a_l\}}
			\end{align*}
		\item
			Modulo: $\mathrm{mod}(x,y) := y\, \mathrm{mod}\, x$
			\begin{align*}
				\forall x \in \N: \mathrm{mod}(x,0) &= 0 \\
				\forall x \in \N\, \forall y \in \N: \mathrm{mod}(x,y+1) &=
				\begin{cases}
					0 = 0\circ \pi_1^3(x,y,\mathrm{mod}(x,y)), & y+1 = x \\
					y+1 = s\circ\pi_2^3(x,y,\mathrm{mod}(x,y)), & \text{sonst}
				\end{cases}
			\end{align*}
			Definiere $A := \{(x,x+1,z): x,z \in \N\}$
			\begin{align*}
				\forall x \in \N\, \forall z \in \N: \chi_A(x,0,z) &= 0 \\
				\forall x \in \N\,\forall z \in \N:\, \forall y \in \N: \chi_A(x,y+1,z)
				&= \chi_{\{0\}}(x-y)\chi_{\{0\}}(y-x) \\
				&= \cdot(\chi_{\{0\}}(-(\pi_1^4,\pi_2^4)),\chi_{\{0\}}(-(\pi_2^4,\pi_1^4)))(x,y,z,\chi_A(x,y,z))
			\end{align*}
		\item konstante Funktion als Verknüpfung von konstanter Nullfunktion und Nachfolgerfunktion
			\begin{align*}
			k = 0 + \sum_{i = 1}^k 1
			\end{align*}
		\item Division mit Rest:
		\begin{align*}
			\forall y \in \N: \%(0,y) &= (0,0) \\
			\forall x \in \N\, \forall y \in \N: \%(x+1,y) &= \begin{cases}
				(0,0), & y = 0 \\
				(\pi_1^2(\%(x,y)),\pi_2^2(\%(x,y)) + 1), & (\pi_2^2(\%(x,y)) + 1 < y) \land y > 0 \\
				(\pi_1^2(\%(x,y)) + 1,0), & \text{sonst} \\
			\end{cases}
		\end{align*}
		Sowohl $A_1 := \{(x,0,z): x \in \N, z \in \N\}$, als auch
		$A_2 := \{(x,y,z): z + 1 < y, x,y,z \in \N\}$ sind primitiv rekursiv.
		\begin{align*}
			\forall x \in \N\, \forall z \in \N: \chi_{A_2}(x,0,z) &= 0 \\
			\forall x \in \N\, \forall z \in \N\, \forall y \in \N: \chi_{A_2}(x,y+1,z)
			&= \chi_{\{0\}}(y-z)(x,y,z)
		\end{align*}
		\item Division (Gaußklammer): $\lfloor \frac{n}{k}\rfloor = \pi_1^2\circ \%(n,k)$ \\

		\item Binomialkoeffizient: (Wir setzen $\binom{x}{y} = 0$ für $y > x$)
		\begin{align*}
			\forall x \in \N: \binom{0}{x} &= \chi_{\{0\}}(x) \\
			\forall x \in \N\,\forall y \in \N: \binom{y+1}{x} &= \begin{cases}
				\chi_{\{0\}}(x-y-1)\chi_{\{0\}}(y+1-x), & y+1 \leq x \\
				\lfloor\frac{(y+1)\binom{y}{x}}{y+1-x}\rfloor, & \text{sonst}
			\end{cases}
		\end{align*}
		\item bijektive Abbildung zwischen $\N \times \N \to \N$: gemäß dem Cantorschen Diagonalverfahren summieren wir die Diagonalen jeweils von links unten nach rechts oben auf
			\begin{align*}
			f(k,n) := k + \sum_{i = 1}^{n + k} i = k + \frac{(n + k) (n + k + 1)}{2} \\
			\begin{pmatrix}
				0 + 0 & 0 + 1 & 0 + 3 & 0 + 6 & \cdots \\
				1 + 1 & 1 + 3 & 1 + 6 & \cdots & \\
				2 + 3 & 2 + 6 & \cdots & & \\
				3 + 6 & \cdots &&&
			\end{pmatrix}
			\end{align*}
		\item Potenzieren einer Zahl $a \in \N$.
			\begin{align*}
			a^0 = 1, \quad a^{n + 1} = a^n a
			\end{align*}
		\item $d:(n,k) \to k$-te Dezimalstelle von $n$. Wir schreiben dafür 
			\begin{align*}
			n = \sum_{i = 0}^l c_i 10^i
			\end{align*}
		und erkennen
			\begin{align*}
			\left\lfloor \frac{n}{10^k} \right\rfloor - 10 \left\lfloor \frac{n}{10^{k + 1}} \right\rfloor &=  \left\lfloor \sum_{i = k}^l a_i 10^{i - k} + \underbrace{10^{-k} \sum_{i = 0}^{k - 1} c_i 10^i}_{< 1} \right\rfloor - 10 \left\lfloor \sum_{i = k + 1}^l a_i 10^{i - (k + 1)} + \underbrace{10^{-(k + 1)} \sum_{i = 0}^{k} c_i 10^i}_{< 1} \right\rfloor \\
			&= \sum_{i = k}^l a_i 10^{i - k} - \sum_{i = k + 1}^l a_i 10^{i - k} = a_k
			\end{align*} 
		\item Wurzel $\left\lfloor \sqrt{n} \right \rfloor$
			\begin{align*}
			\left\lfloor \sqrt{0} \right\rfloor &= 0 \\
			\forall n \in \N : \left\lfloor \sqrt{n + 1} \right\rfloor &= \pbraces{\left\lfloor \sqrt n \right\rfloor + 1} \tilde{\chi}(n) + \left\lfloor \sqrt n \right\rfloor \pbraces{1 - \tilde{\chi}(n)}
			\end{align*}
			wobei
			\begin{align*}
			\tilde{\chi}(n) := \chi_{\{0\}}\pbraces{\pbraces{\left\lfloor \sqrt n \right\rfloor + 1}^2 - (n + 1)} \chi_{\{0\}}\pbraces{(n + 1) - \pbraces{\left\lfloor \sqrt n \right\rfloor + 1}^2}
			\end{align*}
		\item $n \to \left\lfloor 10^n \sqrt{2}  \right\rfloor$
			\begin{align*}
			\left\lfloor 10^0 \sqrt{2}  \right\rfloor = 1 \\
			\left\lfloor 10^{n + 1} \sqrt{2}  \right\rfloor = 10 \left\lfloor 10^n \sqrt{2}  \right\rfloor + d\pbraces{\left \lfloor \sqrt{2 \cdot 10^{2(n + 1)}} \right\rfloor, 0}
			\end{align*}
			oder aber
			\begin{align*}
			\left\lfloor 10^n \sqrt 2 \right\rfloor = \sum_{i = 0}^n d\pbraces{\left \lfloor \sqrt{2 \cdot 10^{2n}} \right\rfloor, i} 10^i
			\end{align*}
	\end{enumerate}

\end{solution}

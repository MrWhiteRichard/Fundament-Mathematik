% --------------------------------------------------------------------------------

\begin{exercise}[216]

\phantom{}
	Für alle $(n_1, \dots, n_k) \in \N^k$  definieren wir $\abraces{n_1, \dots, n_k} := p_1^{n_1 + 1} \cdot \cdots \cdot p_k^{n_k + 1}$, wobei $(p_1, p_2, p_3, \dots) = (2,3,5,7,\dots)$ die Folge der Primzahlen ist. (Runde Klammern für Folgen, spitze Klammern für einzelne Zahlen, die Folgen codieren.)
	\newline
	\newline
	Für jede Funktion $f:\N^k \times \N \to \N$ definieren wir $\hat{f}:\N^k \times \N \to \N$ so:
	\begin{align*}
	\hat{f}(\vec{x}, y) = \abraces{f(\vec{x}, 0), \dots, f(\vec{x}, y - 1)},
	\end{align*}
	also insbesondere $\hat{f}(\vec{x}, 0) = \langle \rangle = 1$, und $\hat{f}(\vec{x}, 1) = \langle f(\vec{x}, 0) \rangle = 2^{f(\vec{x}, 0) + 1}$.
	\newline
	\newline
	Zeigen Sie:
	\begin{enumerate}[label = (\alph*)]
		\item $f$ ist primitiv rekursiv genau dann, wenn $\hat{f}$ primitiv rekursiv ist.
		\item Wenn $f$ total ist, dann ist $f$ genau dann berechenbar, wenn $\hat{f}$ berechenbar ist.
	\end{enumerate}
\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}

\phantom{}
\begin{enumerate}[label = (\alph*)]
	\item
		\begin{enumerate}
			\item[``$\Rightarrow$''] Es sei also vorausgesetzt, dass $f$ primitiv rekursiv ist. Dann gilt
				\begin{align*}
				\hat{f}(\vec{x},0) = 1, \quad \hat{f}(\vec{x}, y + 1) = \hat{f}(\vec{x},y)p_{y+1}^{f(\vec{x}, y) + 1}
				\end{align*}
				also haben wir eine Darstellung gefunden an welcher wir ekrennen, dass $\hat{f}$ primitiv rekursiv ist.
			\item[``$\Leftarrow$''] Nun sei umgekehrt vorausgesetzt, dass $\hat{f}$ primitiv rekursiv ist. Für diese Richtung wollen wir die Funktion
				\begin{align*}
				(\cdot)_\cdot : \N \times \N \to \N : (x,y) \mapsto
				\begin{cases}
				0 &, \text{falls } x = 0 \lor y = 0 \\
				\max\{k \in \N : p_y^k \mid x \} &, \text{sonst}
				\end{cases}
				\end{align*}
				betrachten. $(x)_y$ ist also der Exponent der $y$-ten Primzahl in der Primfaktorzerlegung von $x$. Es gilt
				\begin{align*}
				f(\vec{x},y) = \pbraces{\hat{f}(\vec{x}, y + 1)}_{y + 1} - 1.
				\end{align*}
				Zu zeigen bleibt, dass alle verwendeten Funktionen primitiv rekursiv ist.
				Dafür zeigen wir zunächst, dass die Menge aller Primzahlen primitiv rekursiv
				ist. Wir wissen bereits, dass
				\begin{align*}
					\div: (n,k) \mapsto (q,r) \quad \text{sodass } qk + r = n, 0 \leq r < k
				\end{align*}
				primitiv rekursiv ist und somit auch
				\begin{align*}
					\mathrm{div}: (n,k) \mapsto \chi_{\{0\}}(\Pi_2^2(\div(n,k))).
				\end{align*}
				Es gilt also $\mathrm{div}(n,k) = 1$ genau dann, wenn $k | n$ und $0$ sonst.
				Damit ist auch
				\begin{align*}
					g: (n,z) \mapsto \sum_{k=1}^z \mathrm{div}(n,k)
				\end{align*}
				primitiv rekursiv, und wir erhalten mit $\tau(x) = g(x,x)$ die Anzahl
				aller Teiler von $x$ und damit sehen wir, dass
				\begin{align*}
					\chi_\P(x) = \chi_{\{2\}}(\tau(x))
				\end{align*}
				primitiv rekursiv ist; also sind die Primzahlen als Menge primitiv rekursiv. \newline
				Wir wissen aus Aufgabe 202 bereits, dass für ein beliebieges $P \subseteq \N^k \times \N$ das primitiv rekursiv ist die Funktion
				\begin{align*}
				h_P: \N^k \times \N \to \N: (\vec{x}, z) \mapsto \min\pbraces{\Bbraces{y < z: (\vec{x}, y) \in P} \cup \{z\}}
				\end{align*}
				ebenfalls primitiv rekursiv ist.
%				Definiere den beschränkten Minimierungs-Operator
%				\begin{itemize}
%					\item für Funktionen:
%						\begin{align*}
%							\mu y \leq z(f(n_1,\dots,n_k,y) = 0) :=
%							\begin{cases}
%								\min\{y \leq z: f(n_1,\dots,n_k,y) = 0\} & \exists y \leq z: f(n_1,\dots,n_k,y) = 0 \\
%								z + 1 & \text{sonst}
%							\end{cases}.
%						\end{align*}
%					\item für Relationen:
%					\begin{align*}
%						\mu y \leq z(R(n_1,\dots,n_k,y)) :=
%						\begin{cases}
%							\min\{y \leq z: R(n_1,\dots,n_k,y)\} & \exists y \leq z: R(n_1,\dots,n_k,y) \\
%							z + 1 & \text{sonst}
%						\end{cases}.
%					\end{align*}
%
%				\end{itemize}
%
%				Jetzt verwenden wir Theorem aus dem Internet: \\
%				Wenn $f$ primitiv rekursiv, bzw. $R$ primitiv rekursiv als Relation ist,
%				dann auch $g(n_1,\dots,n_k,z) := \mu y \leq z(f(n_1,\dots,n_k,y) = 0)$,
%				bzw $g(n_1,\dots,n_k,z) := \mu y \leq z(R(n_1,\dots,n_k,y))$. \\
				\newline
				Jetzt haben wir alles gesammelt, um zu zeigen, dass die Funktion
				$p_k$, welche $k$ auf die $k$-te Primzahl abbildet,
				primitiv rekursiv ist. Die Relation
				\begin{align*}
					R(m,y):  \chi_\P(y) = 1 \land m < y
				\end{align*}
				ist als Schnitt zweier primitiv rekursiver Relationen wieder primitiv rekursiv.
				Mit der oberen Schranke $p_{n+1} \leq 2^{2^n}$ (Induktion und die Tatsache $p_{n + 1} \leq p_1\cdots p_n + 1$) erhalten wir für
				\begin{align*}
					g(m,z) := h_R(m,z)
				\end{align*}
				Damit erhalten wir eine primitiv rekursive Darstellung, für die
				Funktion, die $k$ auf die $k$-te Primzahl schickt:
				\begin{align*}
				p_0 := 1, \quad p_{n + 1} := 2\chi_{\{0\}}(n) + (1 - \chi_{\{0\}}(n)) g(p_{n}, 2^{2^n})
				\end{align*}
%				Damit haben wir eine primitiv rekursive Darstellung für $p$:
%				\begin{align*}
%					p_{0} &= 1 \\
%					\varphi_{prim}(n + 1) &= g(\varphi_{prim}(n),2^{2^n}).
%				\end{align*}
				Nun betrachten wir eine weitere primitiv rekursive Relation, nämlich
				\begin{align*}
				S &:= \Bbraces{(n,k,y) \in \N^3 \mid \mathrm{div}(n, p_k^y) = 0} \\
				\chi_S(n,k,y) &= 1 - \mathrm{div}(n, p_k^y)
				\end{align*}
				Jetzt können wir $(n,k) \mapsto (n)_k$ primitv rekursiv beschreiben durch
				\begin{align*}
					(n)_k = h_S(n,k,n) - 1. %[\mu y \leq n(\mathrm{div}(n,p_k^y) = 0)] - 1.
				\end{align*}
		\end{enumerate}
	\item Beweis aus (a) funktioniert auch, wenn für berechenbare $f$ und $\hat{f}$.
\end{enumerate}

\end{solution}

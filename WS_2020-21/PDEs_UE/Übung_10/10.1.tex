% --------------------------------------------------------------------------------

\begin{exercise}

\phantom{}
\textit{(Inhomogeneous boundary data)} Consider the initial value problem (IVP)
$$
\left\{\begin{array}{ll}
u_{t}=u_{x x}-u+\sin (3 \pi x)+x & \text { for } x \in(0,1), \quad t>0, \\
u(0, t)=0 & \text { for } t>0, \\
u(1, t)=1 & \text { for } t>0, \\
u(x, 0)=\sin (\pi x)+x & \text { for } x \in(0,1).
\end{array}\right.
$$
\begin{itemize}
\item[(i)] Transform the IVP into a problem with homogeneous boundary data.
\item[(ii)] Discuss the existence of a solution for the transformed problem.
\item[(iii)] Find a complete orthonormal system consisting of eigenfunctions of the operator $L u=-u_{x x}+u$ with suitable boundary conditions.
\item[(iv)] Find a solution of the IVP using the orthonormal system from (iii).
\end{itemize}

\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}

\phantom{} \begin{itemize}
    \item[(i)] Mit der Transformation $v := u - x$ erhalten wir folgendes Randwertproblem mit homogenen Randbedingungen:
    \begin{align}
        \begin{cases}
            v_t - v_{xx} + v = \sin(3\pi x) & \text{für~} x \in (0, 1),~ t > 0,\\
            v(0, t) = 0 & \text{für~} t > 0,\\
            v(1, t) = 0 & \text{für~} t > 0,\\
            v(x, 0) = \sin(\pi x) & \text{für~} x \in (0, 1).
        \end{cases}
    \end{align}\label{rwp}

    \item[(ii)] Wir wollen Satz 6.19 (Existenz von Lösungen inhomogener Probleme) anwenden; dafür werden wir nun die Voraussetzungen überprüfen.

    Die allgemeine parabolische Differentialgleichung aus der Vorlesung hat die Form
    \begin{align}
        u_t \underbrace{- \mathrm{div}(A \nabla u) + cu}_{=~ L(u)} = f(\cdot, t).
    \end{align}
    Um den Satz anwenden zu können, müssen $A$, $|\nabla A|$ und $c \geq 0$ in $\Omega$ beschränkt und $A$ symmetrisch und gleichmäßig positiv definit sein.
    Im betrachteten eindimensionalen Fall entartet die Matrix $A$ zu einer Konstanten, nämlich $A \equiv 1.$ Ebenso gilt $|\nabla A| \equiv 0$ sowie $c \equiv 1 \geq 0$, womit der Differentialoperator $L$ die richtige Form hat.

    Wegen $v_0 = \sin(\pi x) \in L^2(\Omega)$ und $f = \sin(3\pi x) \in C^0([0, \infty); L^2(\Omega))$ ($f$ ist in unserem Beispiel konstant in $t$) sind alle Voraussetzungen erfüllt.

    Also können wir Satz 6.19 anwenden und erhalten eine Lösung $v$ in der dort postulierten Form.

    \item[(iii)] Wir wollen Funktionen $\varphi_k$ und Zahlen $\lambda_k \in \R$ mit
    \begin{align}\label{98}
        L\varphi_k = - \varphi_k^{\prime\prime} + \varphi_k = \lambda_k\varphi_k
    \end{align}
    finden, wobei $\varphi_k(0) = \varphi_k(1) = 0$ gelten soll.
    Wir formen \eqref{98} um zu $\varphi_k^{\prime\prime} = (1 - \lambda_k) \varphi_k$.
    Die allgemeine Lösung dieser Differentialgleichung ist gegeben durch
    \begin{align*}
        \varphi_k(x) = c_1 \sin(\sqrt{\lambda_k - 1}~ x) + c_2 \cos(\sqrt{\lambda_k - 1}~ x).
    \end{align*}
    Aus der Randbedingung für $x = 0$ folgt sofort $c_2 = 0.$ Aus jener bei $x = 1$ folgt $\sqrt{\lambda_k - 1} = k\pi$ und somit $\lambda_k = 1 + k^2\pi^2, k \in \N.$
    Damit hat unser Orthonormalsystem die Form
    \begin{align*}
        \varphi_k(x) = c_1 \sin(k\pi x),~ k \in \N.
    \end{align*}
    Wegen
    \begin{align*}
        \int_0^1 \sin(n\pi x) \sin(m\pi x) \mathrm{~d}x =
        \begin{cases}
            0, & n \neq m\\
            \frac{1}{2}, & n = m
        \end{cases}
    \end{align*}
    wählen wir noch $c_1 = \sqrt 2$ und erhalten unsere finale Lösung:
    \begin{align}
        \varphi_k(x) &= \sqrt 2 \sin(k\pi x),\\
        \lambda_k &= 1 + (k\pi)^2, k \in \N.
    \end{align}
    Die Dichtheit in $L^2(\Omega)$ folgt mit demselben Argument wie letzte Woche.
    \item[(iv)] Mithilfe von Satz 6.19 können wir nun die konkrete Lösung von \eqref{rwp} bestimmen:
    \begin{align*}
        u(t) &= \mathrm{e}^{-Lt}v_0 + \int_0^t \mathrm{e}^{-L(t-s)} f(s) \mathrm{~d} s\\
        &= \sum_{k = 1}^\infty \mathrm{e}^{-\lambda_k t}(v_0, \varphi_k) \varphi_k + \int_0^t \sum_{k = 1}^\infty \mathrm{e}^{-\lambda_k (t-s)}(f(s), \varphi_k) \varphi_k \mathrm{~d} s\\
        &= \mathrm{e}^{-\lambda_1 t} \sin(\pi x) + \int_0^t \mathrm{e}^{-\lambda_3} \sin(3\pi x) \mathrm{~d} s \\
        &= \mathrm{e}^{-\lambda_1 t} \sin(\pi x) + \frac{1}{\lambda_3} (1 - \mathrm{e}^{-\lambda_3 t}) \sin(3\pi x).
    \end{align*}
    Das ursprüngliche Problem wird also gelöst von
    \begin{align*}
        u = v + x = \mathrm{e}^{-\lambda_1 t} \sin(\pi x) + \frac{1}{\lambda_3} (1 - \mathrm{e}^{-\lambda_3 t}) \sin(3\pi x) + x.
    \end{align*}
    \end{itemize}


\end{solution}

% --------------------------------------------------------------------------------

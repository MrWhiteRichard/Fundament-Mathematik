% --------------------------------------------------------------------------------

\begin{exercise}

\textit{(Galerkin method for the Poisson equation)} \\
Let $\Omega \subset \mathbb{R}^{n}$ be a bounded, open set with smooth boundary.
For $f \in L^{2}(\Omega)$ construct a solution of the Poisson equation
\begin{align}\label{poisson}
  \begin{array}{llll}-\Delta u=f & \text { in } \Omega, & u=0 & \text { on } \partial \Omega\end{array}
\end{align}
using a Galerkin method. To do this, let $\left\{\phi_{k}\right\}$ for $k \in \mathbb{N}$ denote the eigenfunctions of the Laplacian with homogeneous Dirichlet boundary data on $\Omega .$ Then prove that for any $m \in \mathbb{N}$ there exists
\begin{align*}
  u_{m}=\sum_{k=1}^{m} \mathbf{d}_{m}^{k} \phi_{k}, \quad \text { for } \mathbf{d}_{m}^{k} \in \mathbb{R}
\end{align*}

that satisfies
\begin{align*}
  \int_{\Omega} \nabla u_{m} \cdot \nabla \phi_{k} \mathrm{~d}
  x=\int_{\Omega} f \phi_{k}, \quad \text { for } k=1, \ldots, m.
\end{align*}

To finish, show that the sequence $\left\{u_{m}\right\}_{m \in \mathbb{N}}$
converges weakly in $H_{0}^{1}(\Omega)$ to a weak solution of \eqref{poisson}.

\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}

	Wir wissen bereits, dass \eqref{poisson} eine eindeutige schwache Lösung besitzt und können deshalb den Operator 
	\begin{align*}
	K: L^2(\Omega) \to L^2(\Omega): f \mapsto u
	\end{align*}
	mit jener eindeutigen Lösung $u$ betrachten. Wir wissen bereits aus der Vorlesung, dass $K$ ein injektiver, kompakter, selbstadjungierter Operator ist. Wegen der Injektivität von $K$ können wir den inversen Operator 
	\begin{align*}
	L: K\pbraces{L^2(\Omega)} \to L^2(\Omega)
	\end{align*}
	betrachten.Wir interpretieren den Ausdruck \textit{smooth boundary} aus der Angabe als $\partial \Omega \in C^2$, womit dann mit Lemma 6.14 die Gleichheit $D(L) = H^2(\Omega) \cap H_0^1(\Omega)$ gilt. Daraus schließen wir sofort $-\Delta = L$. Den Ausdruck \textit{the eigenfunctions} aus der Angabe interpretieren wir so, dass es sich um eine Orthonormalbasis aus Eigenfunktionen $\phi_k$ von $L^2(\Omega)$ handelt. Sollten sie nicht normiert sein, erschwert das nur die Rechnungen, wenn wir die Orthogonalität nicht fordern müssen wir die Rechnungen wohl nocheinmal überdenken. Wir wissen wegen der Selbstadjungiertheit von $K$ zumindest, dass die Eigenfunktionen zu verschiedenen Eigenwerten orthogonal aufeinander stehen. Alle Eigenfunktionen sind, wie wir aus der Vorlesung wissen, auch schon Eigenfunktionen von $K$ und es gilt \begin{align*}
	K(f) = \sum_{k \in \N} \mu_k \left\langle f, \phi_k \right\rangle \phi_k
	\end{align*}
	wobei $\mu_k$ jeweils Eigenwert bezüglich $K$ von $\phi_k$ sein soll. Wir können die $\mu_k$ so ordnen, dass sie eine monotone Nullfolge bilden. Wegen der Injektivität von $K$ sind alle Eigenwerte ungleich $0$. Weiters wissen wir aus der Vorlesung, dass 
	\begin{align*}
	\mu \in \sigma_p(K) \Leftrightarrow \frac{1}{\mu} \in \sigma_p(L)
	\end{align*}
	also sind die $\lambda_k := \frac{1}{\mu_k}$ die Eigenwerte von $L$.

  Wir wählen $d_m^k := \frac{1}{\lambda_k \|\phi_k\|_{L^2(\Omega)}} \int_\Omega f \phi_k \mathrm{d}x$ und rechnen nach:
  \begin{align*}
  \int_\Omega \nabla u_m \cdot \nabla \phi_k \mathrm{~d}x
  &= -\int_\Omega \Delta u_m~\phi_k \mathrm{~d}x + \int_{\partial\Omega} \underbrace{\phi_k}_{= 0} (\nabla u_m \cdot \nu) \mathrm{~d}s\\
  &= \sum_{j = 1}^m d_m^j \int_\Omega -\Delta \phi_j \phi_k \mathrm{~d}x
  = \sum_{j = 1}^m d_m^j \lambda_j \int_\Omega \phi_j \phi_k \mathrm{~d}x\\
  &= d_m^k \lambda_k \|\phi_k\|_{L^2(\Omega)} = \int_\Omega f \phi_k \mathrm{~d}x.
  \end{align*}

  \begin{align*} %\left| \right|
      \left| \left\langle Kf - u_m, w \right\rangle_{L^2} \right|
      &= \left| \sum_{k = m+1}^\infty \mu_k \langle f, \phi_k\rangle_{L^2} \langle \phi_k, w \rangle \right|\\
      &\leq \sum_{k = m+1}^\infty \left| \sqrt{\mu_k} \langle f, \phi_k \rangle \sqrt{\mu_k} \langle \phi_k, w \rangle \right|\\
      &\leq \sqrt{ \sum_{k = m+1}^\infty \mu_k |\langle f, \phi_k \rangle|^2} \sqrt{ \sum_{k = m+1}^\infty \mu_k |\langle \phi_k, w \rangle|^2} \xrightarrow{m \rightarrow \infty} 0.
  \end{align*}

  \begin{align*}
      \left| \left\langle \nabla\left(Kf - u_m, w\right), \nabla w \right\rangle_{L^2} \right|
      &= \left|\left\langle \nabla Kf, \sum_{k = 1}^\infty \langle w, \phi_k\rangle \nabla \phi_k \right\rangle - \left\langle \nabla u_m, \sum_{k = 1}^\infty \langle w, \phi_k\rangle \nabla \phi_k \right\rangle \right|\\
      &= \left|\sum_{k = 1}^\infty \langle w, \phi_k\rangle \langle \nabla Kf, \nabla \phi_k\rangle - \sum_{k = m+1}^\infty \langle w, \phi_k\rangle \langle \nabla u_m, \nabla \phi_k\rangle - \sum_{k = 1}^m \langle w, \phi_k \rangle \langle f, \phi_k \rangle \right|\\
      %&\stackrel{(\ast)}{=}
      &= \left| \sum_{k = 1}^\infty \langle w, \phi_k\rangle
      \sum_{j = 1}^\infty \mu_j \langle f, \phi_j \rangle \left\langle \nabla \phi_j, \nabla \phi_k \right\rangle
      - \sum_{k = m+1}^\infty \langle w, \phi_k\rangle \langle \nabla u_m, \nabla \phi_k\rangle - \sum_{k = 1}^m \langle w, \phi_k \rangle \langle f, \phi_k \rangle \right|\\
      &\stackrel{(\ast)}{=} \left| \sum_{k = 1}^\infty \langle w, \phi_k \rangle \langle f, \phi_k \rangle - \sum_{k = m+1}^\infty \langle w, \phi_k \rangle \langle \nabla u_m, \nabla \phi_k\rangle - \sum_{k = 1}^m \langle w, \phi_k \rangle \langle f, \phi_k \rangle \right|\\
      &= \left| \sum_{k = m+1}^\infty \langle w, \phi_k \rangle \left(\langle f, \phi_k \rangle - \langle \nabla u_m, \nabla \phi_k \rangle \right)\right|\\
      &\stackrel{(\ast)}{=} \left| \sum_{k = m+1}^\infty \langle w, \phi_k \rangle \langle f, \phi_k \rangle \right|
      \leq \sqrt{ \sum_{k = m+1}^\infty |\langle w, \phi_k \rangle|^2} \sqrt{ \sum_{k = m+1}^\infty |\langle f, \phi_k \rangle|^2} \xrightarrow{m \rightarrow \infty} 0.
  \end{align*}

  \begin{align*}
      (*): \left\langle \nabla u_m, \nabla \phi_k \right\rangle = \sum_{j = 1}^m d_m^j \left\langle \nabla \phi_j, \nabla \phi_k\right\rangle = \begin{cases}
          0, & k > m, \\
          - \lambda_k \langle \phi_j, \phi_k \rangle, & k \leq m.
      \end{cases}
  \end{align*}
\end{solution}

% --------------------------------------------------------------------------------

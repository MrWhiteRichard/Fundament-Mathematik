% --------------------------------------------------------------------------------

\begin{exercise}

Lösen Sie folgendes Problem mithilfe der Methode der Charakteristiken und geben Sie an, wo die Lösung definiert ist:

\begin{align*}
    (y + u) u_x + y u_y
    & =
    x - y, \\
    u(x, 1)
    & =
    1 + x
\end{align*}

\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}

Das dazugehorige Anfangswertproblem lautet

\begin{align*}
    \pderivative[][x]{s} = y + u,
    \pderivative[][y]{s} = y,
    \pderivative[][u]{s} = x - y,
\end{align*}

mit Anfangswerten

\begin{align*}
    x(0, t) = t,
    y(0, t) = 1,
    u(0, t) = 1 + t.
\end{align*}

Anstatt sofort ein lineares $(3 \times 3)$-System aufzustellen, bemerken wir zunächst, dass $y(s, t) = e^s$.
Wir benötigen also bloß folgendes inhomogene lineare $(2 \times 2)$-System (mit konstanten koeffizienten im linearen Teil).

\begin{align*}
    v(s)
    :=
    \begin{pmatrix}
        x(s, t) \\ u(s, t)
    \end{pmatrix}
    \implies
    v^\prime
    =
    \underbrace
    {
        \begin{pmatrix}
            0 & 1 \\
            1 & 0
        \end{pmatrix}
    }_{=: A} v
    +
    \underbrace
    {
        \begin{pmatrix}
            e^s \\ -e^s
        \end{pmatrix}
    }_{=: b(s)},
    \quad
    v(0)
    =
    \begin{pmatrix}
        t \\ 1 + t
    \end{pmatrix}
\end{align*}

Wir bestimmen die Eigenwerte $\lambda_{1, 2}$.

\begin{align*}
    & \implies
    \chi_A(\lambda)
    =
    \begin{vmatrix}
        -\lambda & 1 \\
         1       & -\lambda
    \end{vmatrix}
    =
    \lambda^2 - 1^2
    =
    (\lambda + 1)
    (\lambda - 1) \\
    & \implies
    \lambda_{1, 2} = \pm 1
\end{align*}

Wir bestimmen die zugehörigen Eigenvektoren $v_{1, 2}$.

\begin{align*}
    A - \lambda_1
    =
    \begin{pmatrix}
        -1 &  1 \\
         1 & -1
    \end{pmatrix}
    \mapsto
    \begin{pmatrix}
        1 & -1 \\
        0 &  0
    \end{pmatrix}
    & \implies
    v_1 \in
    \Span \Bbraces
    {
        \begin{pmatrix}
            1 \\ 1
        \end{pmatrix}
    } \\
    A - \lambda_2
    =
    \begin{pmatrix}
        1 & 1 \\
        1 & 1
    \end{pmatrix}
    \mapsto
    \begin{pmatrix}
        1 & 1 \\
        0 & 0
    \end{pmatrix}
    & \implies
    v_2 \in
    \Span \Bbraces
    {
        \begin{pmatrix}
            1 \\ -1
        \end{pmatrix}
    }
\end{align*}

Wir fassen zusammen:

\begin{align*}
    \Lambda := \diag{(\lambda_1, \lambda_2)},
    \quad
    V := (v_1, v_2)
\end{align*}

Wir berechnen die Inverse von $V$.

\begin{align*}
    \begin{bmatrix}
        V \\
        \hline
        I_2
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 &  1 \\
        1 & -1 \\
        \hline
        1 & 0 \\
        0 & 1
    \end{bmatrix}
    \mapsto
    \begin{bmatrix}
        1 & 2 \\
        1 & 0 \\
        \hline
        1 & 1 \\
        1 & 0
    \end{bmatrix}
    \mapsto
    \begin{bmatrix}
        2 & 1 \\
        0 & 1 \\
        \hline
        1 & 1 \\
        1 & 0
    \end{bmatrix}
    \mapsto
    \begin{bmatrix}
        1 & 1 \\
        0 & 1 \\
        \hline
        1/2 & 1 \\
        1/2 & 0
    \end{bmatrix}
    \mapsto
    \begin{bmatrix}
        1 & 0 \\
        0 & 1 \\
        \hline
        1/2 &  1/2 \\
        1/2 & -1/2
    \end{bmatrix}
    =
    \begin{bmatrix}
        I_2 \\
        \hline
        V^{-1}
    \end{bmatrix}
\end{align*}

Somit, können wir die Exponentialmatrix von $A$ ausrechnen.

\begin{align*}
    \implies
    e^{sA}
    =
    V s^{s \Lambda} V^{-1}
    & =
    \begin{pmatrix}
        1 &  1 \\
        1 & -1
    \end{pmatrix}
    \begin{pmatrix}
        e^{s \lambda_1} & 0 \\
        0               & e^{s \lambda_2}
    \end{pmatrix}
    \frac{1}{2}
    \begin{pmatrix}
        1 &  1 \\
        1 & -1
    \end{pmatrix} \\
    & =
    \begin{pmatrix}
        e^s &  e^{-s} \\
        e^s & -e^{-s}
    \end{pmatrix}
    \frac{1}{2}
    \begin{pmatrix}
        1 &  1 \\
        1 & -1
    \end{pmatrix}
    =
    \frac{1}{2}
    \begin{pmatrix}
        e^s + e^{-s} & e^s - e^{-s} \\
        e^s - e^{-s} & e^s + e^{-s}
    \end{pmatrix}
\end{align*}

Nachdem ein Fundamentalsystem nach Spaltenumformungen wieder ein Fundamentalsystem bleibt, werden wir die Exponentialmatrix transformieren.
Das soll die folgenden Rechnungen vereinfachen.

\begin{align*}
    e^{sA}
    \mapsto
    \begin{pmatrix}
        e^s & -e^{-s} / s \\
        e^s &  e^{-s} / 2
    \end{pmatrix}
    \mapsto
    \begin{pmatrix}
        e^s & -e^{-s} \\
        e^s &  e^{-s}
    \end{pmatrix}
    =: Y(s)
\end{align*}

Die Inverse bekommen wir mit dem Determinanten-Trick.

\begin{align*}
    Y(s)^{-1}
    =
    \begin{pmatrix}
         e^{-s} & e^{-s} \\
        -e^s    & e^s
    \end{pmatrix}
\end{align*}

Damit, können wir die Partikulärlösung nun konkret hinschreiben.

\begin{align*}
    \implies
    \begin{pmatrix}
        x(s, t)  \\ u(s, t)
    \end{pmatrix}
    =
    v(s)
    =
    Y(s)
    \pbraces
    {
        Y(0)^{-1} v_0
        +
        \Int[0][s]{Y(\xi)^{-1} b(\xi)}{\xi}
    }
    =
    \begin{pmatrix}
        t e^s + e^s - e^{-s} \\
        t e^s + e^{-s}
    \end{pmatrix}
\end{align*}

Wir erhalten insgesamt also folgende Lösung unserer ODE.

\begin{align*}
    x(s, t) = t e^s + e^s - e^{-s},
    \quad
    y(s, t) = e^s,
    \quad
    u(s, t) = t e^s + e^{-s}
\end{align*}

Wir transformieren $(s, t) \mapsto (x, y)$, indem wir die ersten beiden Gleichungen nach $s$ und $t$ auflösen und in die dritte einsetzen.
Das funktioniert, weil

\begin{align*}
    \det \pderivative[][(x, y)]{(s, t)}
    =
    \begin{vmatrix}
        x_s & x_t \\
        y_s & y_t
    \end{vmatrix}
    =
    \begin{vmatrix}
        t e^s + e^s + e^{-s} & e^s \\
        e^s                  & 0
    \end{vmatrix}
    =
    -e^{2s} \neq 0.
\end{align*}

Konkret ...

\begin{align*}
    & \implies
    s = \ln{y} \\
    & \implies
    t = x/y - 1 + 1/y^2 \\
    & \implies
    u = x - y + 2/y
\end{align*}

Die Lösung ist, laut unseren Rechnungen, auf $\R \times \R^+$ definiert.
\Quote{Zufälligerweise} gilt sie sogar auf $\R \times (\R \setminus \Bbraces{0})$.

\end{solution}

% --------------------------------------------------------------------------------

\begin{solution}

Wie bereits in den vorigen beiden Aufgaben lösen wir

\begin{align*}
    \pderivative[][x]{s} = y + u \quad \text{mit} \quad x(0,t) = t, \qquad
    \pderivative[][y]{s} = y \quad \text{mit} \quad y(0,t) = 1, \qquad
    \pderivative[][u]{s} = x - y \quad \text{mit} \quad u(0,t) = 1 + t .
\end{align*}

Die zweite Differentialgleichung lässt sich leicht lösen, nämlich ist $y(s,t) = e^s$ eine Lösung die zudem noch die zusätzliche Bedingung erfüllt. Die anderen beiden Differentialgleichungen wollen wir ein weiteres Mal ableiten und erhalten so

\begin{align*}
    \pderivative[2][x]{s} = \pderivative[][y]{s} + \pderivative[][u]{s} = y  + x - y = x \quad \text{und} \quad \pderivative[2][u]{s} = \pderivative[][x]{s} - \pderivative[][y]{s} = y + u - y = u,
\end{align*}

also zweimal die gleiche homogene Differentialgleichung. Diese haben das charakteristische Polynom $\chi(\lambda) = \lambda^2 -1$ also die Lösung $x(s,t) = c_1 e^s + c_2 e^{-s}$ und $u(s,t) = c_3 e^s + c_4 e^{-s}$, wobei die scheinbaren Konstanten noch von $t$ abhängen können. Nun wissen wir außerdem 

\begin{align*}
    c_1 e^s - c_2 e^{-s} = \pderivative[][x]{s}(s)\stackrel{!}{=} y + u = e^s + c_3 e^s + c_4 e^{-s}, \quad \text{also} \quad c_1 = 1 + c_3 \quad \text{und} \quad -c_2 = c_4 
\end{align*}

Diese beiden Gleichungen können wir nützen und erhalten 

\begin{align*}
    t = x(0,t) = c_1 + c_2 \quad \text{und} \quad 1 + t = u(0,t) = c_3 + c_4 = c_1 - 1 - c_2
\end{align*}

Das Lösen dieses Gleichungssystems ist nun wirklich nicht mehr schwer und wir erhalten

\begin{align*}
    c_1 = 1 + t, \quad c_2 = -1, \quad c_3 = t \quad \text{und} \quad c_4 = 1
\end{align*}

also die Funktionen

\begin{align*}
    x(s,t) = (1 + t) e^s - e^{-s} \quad \text{und} \quad u(s,t) = t e^s + e^{-s}
\end{align*}

Aus $y = e^s$ erhalten wir schnell $s = \ln(y)$ und damit 

\begin{align*}
    x = (1+t) e^s - e^{-s} = (1 + t)y - y^{-1} \quad \text{umgeformt also} \quad t = \frac{x}{y} + y^{-2} - 1 
\end{align*}

woraus sich insgesamt

\begin{align*}
    u(x,y) = t e^s + e^{-s} = \left(\frac{x}{y} + y^{-2} - 1 \right) y + y^{-1} = x + \frac{2}{y} - y
\end{align*}

ergibt.
Die Lösung ist auf $\R \times \R \setminus \{0\}$ wohldefiniert.
\textbf{erfüllt sie dort auch überall die Differentialgleichung?}

\end{solution}

% --------------------------------------------------------------------------------

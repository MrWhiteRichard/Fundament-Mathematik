% --------------------------------------------------------------------------------

\begin{exercise}

\phantom{}

\begin{enumerate}[label = (\roman*)]

    \item Lösen Sie das Randwertproblem für die Laplacegleichung in ebenen Polarkoordinaten

    \begin{align*}
        (\Delta u)(r, \varphi)
        & =
        0 ~\text{für}~ r < R, \\
        u(R, \varphi)
        & =
        f(\varphi) ~\text{für alle}~ \varphi,
    \end{align*}

    wobei

    \begin{align*}
        \Delta u
        =
        u_{rr} + \frac{1}{r} u_r + \frac{1}{r^2} u_{\varphi \varphi}
    \end{align*}

    der Laplaceoperator in Polarkoordinaten, $R > 0$ eine positive Konstante und $f$ eine stückweise stetig differenzierbare $2 \pi$-periodische Funktion ist?

    \item Wie sieht die Lösung konkret im Fall

    \begin{align*}
        f(\varphi)
        =
        \begin{cases}
             0 & \varphi = 0, \pi \\
             1 & 0 < \varphi < \pi \\
            -1 & \pi < \varphi < 2 \pi
        \end{cases}
    \end{align*}

    mit $R = 1$ aus?

\end{enumerate}

\textit{Hinweis:}
Verwenden Sie einen Separationsansatz.
Betrachten Sie dazu zunächst Einzellösungen $u_n$ der Gestalt $u_n(r, \varphi) = v_n(r) \cdot w_n(\varphi)$ (mit $w_n$ $2 \pi$-periodisch), welche die Differentialgleichung erfüllen und insbesondere $C^2$ im Nullpunkt sind.
Die gesuchte Gesamtlösung ergibt sich dann als Summe über die Einzellösungen $u_n$ mit geeigneten Koeffizienten.
Falls Sie dabei auf die homogene eulersche Differentialgleichung 2. Ordnung stoßen, verwenden Sie Aufgabe 6 von Blatt 1 oder schlagen sie in einer beliebigen Quelle ein Fundamentalsystem von Lösungen nach.

\end{exercise}

% --------------------------------------------------------------------------------

\includegraphicsboxed
[EDGW]
[
    Lösen einer Eulerschen Differentialgleichung 2. Ordnung nach
    \href{https://de.wikipedia.org/wiki/Eulersche_Differentialgleichung}{Wikipedia}
]
{Eulersche Differentialgeichung 2-Ordnung - Wikipedia.png}

\begin{comment}

\begin{solution}

\phantom{}

\begin{enumerate}[label = (\roman*)]

    \item Weil $f$ stückweise stetig differenzierbar und $2 \pi$-periodisch ist, hat es die Darstellung

    \begin{align*}
        f = \sum_{n=1}^N \1_{A_n} f_n,
        \quad
        N \in \N,
        \quad
        \bigcup_{n=1}^N A_n = [0, 2 \pi),
        \quad
        \Forall n = 1, \ldots, N:
        f_n |_{A_n} \in C^1.
    \end{align*}

    Wir folgen dem Hinweis, und betrachten die PDE einmal nur auf einem $A_n$ mit $n = 1, \ldots, N$.
    Sei $\varphi \in (0, 2 \pi]$ fest gewählt.
    Die Randbedingung und Separation geben uns

    \begin{align*}
        f_n(\varphi) = u_n(R, \varphi) = v_n(R) w_n(\varphi)
        \stackrel{!}{\implies}
        f_n^\primeprime(\varphi) = v_n(R) w_n^\primeprime(\varphi).
    \end{align*}

    Die Bedingung an den Laplaceoperator führt andererseits zu

    \begin{align*}
        0 \stackrel{!}{=}
        \Delta u_n
        =
        \pderivative[2]{r} (v_n w_n)
        +
        \frac{1}{r} \pderivative{r} (v_n w_n)
        +
        \frac{1}{r^2} \pderivative[2]{\varphi} (v_n w_n)
        =
        v_n^\primeprime w_n
        +
        \frac{1}{r} v_n^\prime w_n
        +
        \frac{1}{r^2} v_n w_n^\primeprime \\
    \end{align*}

    Jetzt multiplizieren wir mit $r^2 v_n(R)$ und \Quote{stoßen} auf eine \Quote{eulersche Differentialgleichung 2. Ordnung}.

    \begin{align*}
        \implies
        0 =
        r^2 v_n^\primeprime v_n(R) w_n
        +
        r v_n^\prime v_n(R) w_n
        +
        v_n v_n(R) w_n^\primeprime
        =
        f_n(\varphi) r^2 v_n^\primeprime
        +
        f_n(\varphi) r v_n^\prime
        +
        f_n^\primeprime(\varphi) r v_n
    \end{align*}

    Unsere \Quote{beliebige Quelle} an der Stelle ist (NATÜRLICH, was sonst?) Wikipedia!

    ACHTUNG: Die Nullstellen hängen formal immer noch von $\varphi$ ab!

    \begin{align*}
        \lambda_n(\varphi)
        =
        \frac{f_n(\varphi) - f_n(\varphi)}{2 f_n(\varphi)}
        \pm
        \sqrt
        {
            \frac{(f_n(\varphi) - f_n(\varphi))^2}{4 f_n(\varphi)^2}
            -
            \frac{f_n^\primeprime(\varphi)}{f_n(\varphi)}
        }
        =
        \sqrt{-\frac{f_n^\primeprime(\varphi)}{f_n(\varphi)}}
    \end{align*}

    Wir machen die Fallunterscheidungen und bekommen ein Fundamentalsystem $V_{n, \varphi, 1}, V_{n, \varphi, 2}$.
    Wir wählen zwei beliebige Koeffizienten $c_{n, 1}, c_{n, 2} \in \R$ an.
    (Die hängen NICHT von $\varphi$ ab.)

    \begin{align*}
        v_{n, \varphi, c_{n, 1}, c_{n, 2}} = c_{n, 1} V_{n, \varphi, 1} + c_{n, 2} V_{n, \varphi, 2}
        & \implies
        w_{n, c_{n, 1}, c_{n, 2}}(\varphi) = \frac{f_n(\varphi)}{v_{n, \varphi, c_{n, 1}, c_{n, 2}}(R)} \\
        & \implies
        u_{n, \varphi, c_{n, 1}, c_{n, 2}}
        =
        v_{n, \varphi, c_{n, 1}, c_{n, 2}}
        w_{n, c_{n, 1}, c_{n, 2}}(\varphi)
        =
        \frac
        {
            f_n(\varphi)
            v_{n, \varphi, c_{n, 1}, c_{n, 2}}
        }{
            v_{n, \varphi, c_{n, 1}, c_{n, 2}}(R)
        }
    \end{align*}

    Diese Einzellösungen setzen wir nun zusammen.

    \begin{align*}
        u_c(r, \varphi)
        =
        \sum_{n=1}^N \1_{A_n} u_{n, \varphi, c_{n, 1}, c_{n, 2}},
        \quad
        c = ((c_{n, 1}, c_{n, 2}))_{n=1}^N
    \end{align*}

    \item

    \begin{align*}
        f = \1_{(0, \varphi)} - \1_{(\pi, 2 \pi)}
        \implies
        \lambda_n = 0
        \implies
        V_{n, 1} = 1, V_{n, 2} = \ln{r}
        \implies
        v_n = c_{n, 1} + c_{n, 2} \ln
    \end{align*}

    \begin{align*}
        v_n(R)
        =
        c_{n, 1} + \underbrace{c_{n, 2} \ln{R}}_0
        \implies
    \end{align*}

    \begin{enumerate}

        \item \Quote{$\varphi = 0, \pi$}:
        \begin{align*}
            w_1(\varphi)
            =
            \frac{f_1(\varphi)}{v_1(R)} = 0
            \implies
            u_1 = 0
        \end{align*}

        \item \Quote{$0 < \varphi < \pi$}:
        \begin{align*}
            w_2(\varphi)
            =
            \frac{f_2(\varphi)}{v_2(R)}
            =
            \frac{1}{c_{1, 2}}
            \implies
            u_2(r, \varphi)
            =
            \frac{v_2(r)}{c_{1, 2}}
            =
            \frac{c_{1, 2} + c_{2, 2} \ln{r}}{c_{1, 2}}
            =
            1 + \underbrace{\frac{c_{2, 2}}{c_{1, 2}}}_{=: \eta} \ln{r}
        \end{align*}

        \item \Quote{$\pi < \varphi < 2 \pi$}:
        \begin{align*}
            w_3(\varphi)
            =
            \frac{f_3(\varphi)}{v_3(R)}
            =
            \frac{-1}{c_{1, 3}}
            \implies
            u_3(r, \varphi)
            =
            -\frac{v_3(r)}{c_{1, 3}}
            =
            -\frac{c_{1, 3} + c_{2, 3} \ln{r}}{c_{1, 3}}
            =
            -1 \underbrace{-\frac{c_{2, 3}}{c_{1, 3}}}_{=: \zeta} \ln{r}
        \end{align*}

    \end{enumerate}

    \begin{align*}
        \implies
        u(r, \varphi)
        =
        \begin{cases}
            0,                & \varphi = 0, \pi, \\
            \eta  \ln{r} + 1, & 0 < \varphi < \pi, \\
            \zeta \ln{r} - 1, & \pi < \varphi < 2 \pi
        \end{cases}
    \end{align*}

\end{enumerate}

\end{solution}

\end{comment}

% --------------------------------------------------------------------------------

\begin{solution}

\phantom{}

\begin{enumerate}[label = (\roman*)]

    \item Wir machen den Ansatz $u(r, \varphi) = v(\varphi) w(\varphi)$.
    Einsetzen in die PDE liefert Folgendes.

    \begin{align*}
        v_{rr}(r) w(\varphi)
        +
        \frac{1}{r}
        v_r(r)w(\varphi)
        +
        \frac{1}{r^2}
        v(r)w_{\varphi\varphi}(\varphi) = 0
        \implies
        \frac
        {
            r^2 v_{rr}(r)
            +
            r   v_r(r)
        }{v(r)}
        =
        -\frac
        {
            w_{\varphi \varphi}(\varphi)
        }{w(\varphi)}
        =
        \lambda_{r, \varphi}
    \end{align*}

    Da die linke Seite nur von $r$ und die rechte Seite nur von $\varphi$ abhängt, ist $\lambda := \lambda_{r, \varphi}$ konstant.
    Wir erhalten also zwei Differentialgleichung.
    Die $w$-ODE lautet wie folgt (mit dem charakteristischen Polynom $\chi$).

    \begin{align*}
        w_{\varphi \varphi} + \lambda w = 0,
        \quad
        \chi(\mu) = \mu^2 + \lambda
    \end{align*}

    Für $\lambda \neq 0$ erhalten wir die folgende Lösung.

    \begin{align*}
        w(\varphi)
        =
        c_1
        \exp \pbraces
        {
            i \varphi \sqrt{\lambda}
        }
        +
        c_2
        \exp \pbraces
        {
            -i \varphi \sqrt{\lambda}
        },
        \quad
        c_1, c_2 \in \R
    \end{align*}

    Die Lösung soll $2 \pi$-periodisch sein, also $\sqrt{\lambda} \in \Z \setminus \Bbraces{0}$, also $\lambda = n^2$ mit $n \in \Z \setminus \Bbraces{0}$.
    Weil $\sqrt{\lambda} \in \R$, dürfen wir ein trigonometrisches Fundamentalsystem wählen.
    Wir schreiben die möglichen Lösungen wie folgt an.
    (Für $-n \in \N$, können wir das $-1$ aus dem $\sin$ ziehen und in das $c_{n, 1}$ stecken und der $\cos$ schluckt es sowieso.)

    \begin{align*}
        w_n(\varphi)
        =
        c_{n, 1} \cos(n \varphi)
        +
        c_{n, 2} \sin(n \varphi),
        \quad
        n \in \N,
        c_{n, 1}, c_{n, 2} \in \R
    \end{align*}

    Sei nun $\lambda = 0$.

    \begin{align*}
        \implies
        w_{\varphi \varphi} = 0
        \implies
        w_0(\varphi)
        =
        \pbraces
        {
            \Int
            {
                \Int
                {
                    w_{\varphi \varphi}(\phi)
                }{\phi}
            }{\phi}
        }(r)
        =
        c_{0, 1} \varphi + c_{0, 2},
        \quad
        c_{0, 1}, c_{0, 2} \in \R
    \end{align*}

    Davon sind aber bloß die konstanten Funktionen $2 \pi$-periodische Lösungskandidaten.
    Daher, muss $c_{0, 1} = 0$.

    Wir widmen uns nun der $\varphi$-ODE.
    Diese ist eine homogene eulersche Differentialgeichung.

    \begin{align*}
        a_2 r^2 v_{rr}
        +
        a_1 r v_r
        +
        a_0 v = 0,
        \quad
        a_2 = 1, \quad a_1 = 1, \quad a_0 = -\lambda
    \end{align*}

    Wie wir solch eine Differentialgleichung lösen wissen wir schon von Blatt 1 Aufgabe 6, oder Wikipedia also Abbildung \ref{fig:EDGW} (oder beides).

    \begin{align*}
        \Frac
        {2 a_2}
        {
            a_2 - a_1
            \pm
            \sqrt
            {
                (a_2 - a_1)^2
                -
                4 a_2 a_0
            }
        }
        =
        \pm \sqrt{\lambda}
    \end{align*}

    Für $\lambda \neq 0$, muss $\sqrt{\lambda} \neq -\sqrt{\lambda}$, und wir erhalten wir die folgende Lösung.
    (Für $-n \in \N$, vertauschen die Konstanten $c_{n, 3}$ und $c_{n, 4}$.)

    \begin{align*}
        v_n(r)
        =
        c_{n, 3} r^n + c_{n, 4} r^{-n},
        \quad
        n \in \N,
        \quad
        c_{n, 3}, c_{n, 4} \in \R
    \end{align*}

    Für $\lambda = 0$ erhalten wir

    \begin{align*}
        v_0(r)
        =
        c_{0, 3} r^0 + c_{0, 4} r^0 \ln{r},
        \quad
        c_{0, 3}, c_{0, 4} \in \R
    \end{align*}

    $u$ soll nun $C^2$ im Nullpunkt sein.
    Dort ist allerdings $v_n$, $n \in \N_0$ nur definiert, falls $c_{n, 4} = 0$.
    Insgesamt liefert der Separationsansatz folgende Lösungskandidaten.

    \begin{gather*}
        u_n(r,\varphi)
        =
        v_n(r) w_n(\varphi)
        =
        c_{n, 3} r^n
        \pbraces
        {
            c_{n, 1} \cos(n \varphi)
            +
            c_{n, 2} \sin(n \varphi)
        }
        =
        r^n
        \pbraces
        {
            a_n \cos(n \varphi)
            +
            b_n \sin(n \varphi)
        }, \\
        n \in \N,
        \quad
        c_{n, 1}, c_{n, 2}, c_{n, 3} \in \R,
        \quad
        a_n := c_{n, 3} c_{n, 1},
        \quad
        b_n := c_{n, 3} c_{n, 2}
    \end{gather*}

    \begin{gather*}
        u_0(r, \varphi)
        =
        v_0(r) w_0(\varphi)
        =
        c_{0, 3}
        c_{0, 2}
        =:
        a_0, \\
        c_{0, 3}, c_{0, 2} \in \R
    \end{gather*}

    Weil jeder einzelne dieser Lösungskandidaten seinen Beitrag leisten könnte, summieren wir diese und hoffen (durch die Koeffizienten) auf das Beste.
    (Sei dabei $b_0 \in \R$ beliebig. Es leistet aber keinen Beitrag und dient nur zur Formalität.)

    \begin{align*}
        u(r, \varphi)
        \stackrel{!}{=}
        \sum_{n=0}^\infty
        r^n
        \pbraces
        {
            a_n \cos(n \varphi)
            +
            b_n \sin(n \varphi)
        }
    \end{align*}

    Wir wollen nun noch die Koeffizienten bestimmen.

    \includegraphicsboxed[Blue_K_3.1.9][Blümlinger - Analysis 3]{Blue-Korollar-3-1-9.png}

    Wir berechnen also deren Fourierkoeffizienten $\tilde{a}_0, \tilde{a}_n, \tilde{b}_n$, $n \in \N$, frei nach Abbildung \ref{fig:FCS}.
    Es muss auf jeden Fall $\tilde{a}_0 = 0$, ansonsten gibt's ein kleines Problem!

    \includegraphicsboxed[FCS][Fourier-Cheat-Sheet]{Fourier-Cheat-Sheet.png}

    Die offiziellen Koeffizienten bekommen wir nun durch normalisieren.
    (Wir wollen schließlich die Randbedingung $u(R, \cdot) = f$ gewährleisten.)

    \begin{align*}
        a_n := \frac{\tilde{a}_n}{R^n},
        \quad
        b_n := \frac{\tilde{b}_n}{R^n}
    \end{align*}

    \begin{itemize}

        \item \Quote{Wohldefiniertheit}:
        Sei $\varphi \in \R$ fest.
        Laut Abbildung \ref{fig:Blue_K_3.1.9}, konvergiert die Fouriereihe von $u(R, \cdot) = f$.
        Diese kann man (für jenes feste $\varphi$) als Potenzreihe in $R$ auffassen.
        Weil diese ja in $R$ konvergiert, hat sie auch einen (sogar noch) größeren Konvergenzradius.
        Insbesondere konvergiert auch (die Potenzreihe) $u(r, \varphi)$.

        \item \Quote{Ableitung}:
        Weil $u(r, \varphi)$ als Potenzreihe absolut und somit gleichmäßig konvergiert, dürfen wir Limitten, also auch Ableitungsoperatoren hineinziehen.

        \begin{align*}
            \implies
            (\Delta u)(r, \varphi)
            & =
            u_{rr} + \frac{1}{r} u_r + \frac{1}{r^2} u_{\varphi \varphi} \\
            & =
            \sum_{n=2}^\infty
            n (n-1) r^{n-2}
            \pbraces
            {
                a_n \sin(n \varphi)
                +
                b_n \cos(n \varphi)
            } \\
            & +
            \sum_{n=2}^\infty
            n r^{n-2}
            \pbraces
            {
                a_n \sin(n \varphi)
                +
                b_n \cos(n \varphi)
            } \\
            & -
            \sum_{n=2}^\infty
            n^2 r^{n-2}
            \pbraces
            {
                a_n \sin(n \varphi)
                +
                b_n \cos(n \varphi)
            } \\
            & =
            \sum_{n=2}^\infty
            (
                n (n-1) r^{n-2}
                +
                n r^{n-2}
                -
                n^2 r^{n-2}
            )
            \pbraces
            {
                a_n \sin(n \varphi)
                +
                b_n \cos(n \varphi)
            }
            = 0
        \end{align*}

        \item \Quote{Randbedingung}:
        Das folgt unmittelbar aus der \Quote{Wahl} der Fourierkoeffizienten.

    \end{itemize}

    \item

    \begin{align*}
        u(R, \varphi)
        =
        \sum_{n=1}^\infty
        R^n
        \pbraces
        {
            a_n \sin{(n\varphi)}
            +
            b_n \cos{(n\varphi)}
        }
    \end{align*}

    Nachdem $f$ ungerade ist, fallen die $\cos$-Koeffizienten weg, und wir müssen nur noch die $\sin$-Koeffizienten berechnen.
    Außerdem, ist ja $R = 1$; wir können $R^n$ also getrost weglassen.
    $\Forall n \in \N:$

    \begin{align*}
        a_n & = 0, \\
        b_n
        & =
        \frac{1}{\pi}
        \Bigg (
            \Int[0][\pi]
            {
                \underbrace{f(\varphi)}_1
                \sin{(n \varphi)}
            }{\varphi}
            +
            \Int[\pi][2 \pi]
            {
                \underbrace{f(\varphi)}_{-1}
                \sin(n \varphi)
            }{\varphi}
        \Bigg )
        =
        \frac{1}{\pi}
        \pbraces
        {
            -\frac{1}{n}
            \cos(n \varphi)
            \big |_{\varphi = 0}^\pi
            +
            \frac{1}{n}
            \cos(n \varphi)
            \big |_{\varphi = \pi}^{2 \pi}
        } \\
        & =
        \frac{1}{n \pi}
        \pbraces
        {
            1 - \cos{n \pi}
            +
            \cos{2n \pi} - \cos{n \pi}
        }
        =
        \frac{2}{n \pi}
        \pbraces
        {
            1 - (-1)^n
        }
        =
        \begin{cases}
            0,               & n \in 2 \N, \\
            \frac{4}{n \pi}, & n \in 2 \N - 1
        \end{cases}
    \end{align*}

\end{enumerate}



\end{solution}

% --------------------------------------------------------------------------------

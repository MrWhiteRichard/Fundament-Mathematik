% --------------------------------------------------------------------------------

\begin{exercise}

\phantom{}

\begin{enumerate}[label = \textbf{\alph*)}]

  \item Beweisen Sie die Aussage aus Ex. 49 des Vorlesungsskriptes.

  \includegraphicsboxed{NumPDEs/NumPDEs - Exercise 49.png}

  \item Beweisen Sie die Aussage aus Ex. 50 des Vorlesungsskriptes durch direktes Arbeiten mit der Matrix ohne Verwendung von Brezzi (oder darauf aufbauenden Resultaten).

  \includegraphicsboxed{NumPDEs/NumPDEs - Exercise 50.png}

\end{enumerate}

\end{exercise}

% --------------------------------------------------------------------------------

\begin{solution}

\phantom{}

\begin{enumerate}[label = \textbf{\alph*)}]

  \item Let $\Bbraces{\phi_1, \dots, \phi_n}$ be a basis of $X_h$ and $\Bbraces{\psi_1, \dots, \psi_m}$ be a basis of $Y_h$.
  Consider the following definitions of $A \in \R^{n \times n}$, $B \in \R^{m \times n}$, $c \in \R^n$, and $d \in \R^m$.

  \begin{align*}
    A_{j k} & := a(\phi_k, \phi_j), & c_j & := x^\ast(\phi_j), & j, k = 1, \dots, n, \\
    B_{j k} & := b(\phi_k, \psi_j), & d_j & := y^\ast(\psi_j), & j    = 1, \dots, n, \quad k = 1, \dots, m
  \end{align*}

  Since the computation of the discrete solution boils down to

  \begin{align*}
    x^\ast(\phi_j) & = \sum_{i=1}^n x_i a(\phi_i, \phi_j) + \sum_{i=1}^m y_i b(\phi_j,\psi_i), & j & = 1, \dots, n \\
    y^\ast(\psi_j) & = \sum_{i=1}^m y_i b(\phi_i, \psi_j),                                     & j & = 1, \dots, m,
  \end{align*}

  we can reformulate the problem to the following:
  Find $x_h = \sum_{i=1}^n x_i \phi_i$ and $y_h = \sum_{i=1}^m y_i \psi_i$ such that

  \begin{align*}
    \begin{pmatrix}
      A & B^{\top} \\
      B & 0
    \end{pmatrix}
    \begin{pmatrix}
      x_h \\ y_h
    \end{pmatrix}
    =
    \begin{pmatrix}
      c \\ d
    \end{pmatrix}.
  \end{align*}

  \begin{comment}

    \item Let $B$ be regular, then the $m$ lower rows of $M$ must be linearly independent,
    which implies $\ran(B) = \R^m$. \\
    Conversely, suppose $M\cdot x = 0$ for $x \neq 0$. This implies $(x_1,\dots,x_n) \in \ker(B)$.
    Since $A$ is positive definite on $\ker$

  \end{comment}

  \item Dass $A \in \R^{n \times n}$ positiv definit auf $\ker B$ ist heißt genau, dass

  \begin{align*}
    \Forall x \in \ker B \setminus \Bbraces{0}:
      x^\top A x > 0.
  \end{align*}

  \begin{itemize}

    \item \Quote{$\implies$}:

    Sei $M$ regulär, dann hat $B^\top$ vollen Spaltenrang, also $B$ vollen Zeilenrang und ist damit surjektiv.

    \begin{align*}
      M \in \GL_{n+m}(\R)
      \implies
      B^\top ~\text{voller Spaltenrang}~
      \implies
      B ~\text{voller Zeilenrang}~
      \implies
      B ~\text{surjektiv}
    \end{align*}

    \item \Quote{$\impliedby$}:

    Sei $B \in \R^{m \times n}$ surjektiv.
    Seien weiters $x \in \R^n$, und $y \in \R^m$, sodass $z := \begin{pmatrix} x \\ y \end{pmatrix} \in \ker M$, d.h.

    \begin{align*}
      0
      =
      M z
      =
      \begin{pmatrix}
        A & B^\top \\
        B & 0
      \end{pmatrix}
      \begin{pmatrix}
        x \\ y
      \end{pmatrix}
      =
      \begin{pmatrix}
        A x + B^\top y \\
        B x
      \end{pmatrix}.
    \end{align*}

    Damit ist $B x = 0$, d.h. $x \in \ker B$.

    \begin{multline*}
      0 =
      z^\top M z
      =
      (x^\top, y^\top)
      \begin{pmatrix}
        A & B^\top \\
        B & 0
      \end{pmatrix}
      \begin{pmatrix}
        x \\ y
      \end{pmatrix}
      =
      (x^\top, y^\top)
      \begin{pmatrix}
        A x + B^\top y \\
        B x
      \end{pmatrix} \\
      =
      x^\top A x + x^\top B^\top y + y^\top B x
      =
      x^\top A x + (B x)^\top y
      =
      x^\top A x
    \end{multline*}

    Weil $A$ auf $\ker B \ni x$ positiv definit ist, muss nun $x = 0$.
    Wenn wir oben einsetzen, erhalten wir zudem $B^\top y = 0$.
    Weil $B$ ja surjektiv ist, ist $B^\top$ injektiv.
    Damit erhalten wir $y = 0$.

    Insgesamt ist also $z = 0$.
    Weil $z \in \ker M$ beliebig war, gilt $\ker M = \Bbraces{0}$.
    Damit ist $M \in \R^{(n+m) \times (n+m)}$ injektiv und somit auch bijektiv, d.h. $M \in \GL_{n + m}(\R)$.

  \end{itemize}

\end{enumerate}

\end{solution}

% --------------------------------------------------------------------------------
